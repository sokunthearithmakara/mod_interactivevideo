{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Main module for the decision plugin.\n *\n * @module     ivplugin_decision/main\n * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport $ from 'jquery';\nimport Base from 'mod_interactivevideo/type/base';\nimport DynamicForm from 'core_form/dynamicform';\nimport {dispatchEvent} from 'core/event_dispatcher';\nexport default class Decision extends Base {\n    /**\n     * Initializes the decision plugin for interactive videos.\n     *\n     * This method sets up event listeners and handles the logic for decision points\n     * within the video. If the video is not in edit mode, it filters out decision\n     * annotations and prevents skipping certain decision points based on their\n     * properties.\n     *\n     * @method init\n     * @memberof DecisionPlugin\n     * @instance\n     *\n     * @example\n     * // Initialize the decision plugin\n     * decisionPlugin.init();\n     */\n    init() {\n        if (!this.isEditMode()) {\n            const decisions = this.annotations.filter((d) => d.type == 'decision');\n            const notSkip = decisions.filter((d) => d.char1 != 1);\n            if (notSkip.length == 0) {\n                return;\n            }\n            let self = this;\n            $(document).on('timeupdate', function(e) {\n                const cantSkip = decisions.filter((d) => d.char1 != 1 && !d.viewed);\n                cantSkip.sort((a, b) => a.timestamp - b.timestamp);\n                if (cantSkip.length == 0) {\n                    return;\n                }\n                const t = Number(e.originalEvent.detail.time);\n                const firstCantSkip = cantSkip[0];\n                if (t > Number(firstCantSkip.timestamp)) {\n                    self.player.seek(Number(firstCantSkip.timestamp) - 0.05);\n                }\n            });\n        }\n    }\n\n    /**\n     * Add an annotation\n     * @param {Array} annotations The annotations array\n     * @param {number} timestamp The timestamp\n     * @param {number} coursemodule The course module id\n     * @returns {void}\n     */\n    addAnnotation(annotations, timestamp, coursemodule) {\n        $('#addcontent, #importcontent').addClass('no-pointer-events');\n        let self = this;\n        this.annotations = annotations;\n        if (!this.isBetweenStartAndEnd(timestamp)) {\n            const message = M.util.get_string('interactioncanonlybeaddedbetweenstartandendtime', 'mod_interactivevideo', {\n                \"start\": self.convertSecondsToHMS(self.start),\n                \"end\": self.convertSecondsToHMS(self.end),\n            });\n            self.addNotification(message);\n            return;\n        }\n\n        if (self.isAlreadyAdded(timestamp)) {\n            self.addNotification(M.util.get_string('interactionalreadyexists', 'mod_interactivevideo'));\n            return;\n        }\n\n        if (self.isInSkipSegment(timestamp)) {\n            self.addNotification(M.util.get_string('interactionisbetweentheskipsegment', 'mod_interactivevideo'));\n            return;\n        }\n\n        const startHMS = self.convertSecondsToHMS(self.start);\n        const endHMS = self.convertSecondsToHMS(self.end);\n        const timestampHMS = timestamp > 0 ? self.convertSecondsToHMS(timestamp) : startHMS;\n\n        const data = {\n            id: 0,\n            timestamp: timestamp > 0 ? timestamp : self.start,\n            timestampassist: timestampHMS,\n            title: self.prop.title,\n            start: startHMS,\n            end: endHMS,\n            contextid: M.cfg.contextid,\n            type: self.prop.name,\n            courseid: self.course,\n            cmid: coursemodule,\n            annotationid: self.interaction,\n            hascompletion: self.prop.hascompletion ? 1 : 0,\n        };\n\n        $('#annotationwrapper table').hide();\n        $('#annotationwrapper').append('<div id=\"form\" class=\"w-100 p-3\"></div>');\n        $(\"#contentmodal\").modal('hide');\n        $('#addcontentdropdown a').removeClass('active');\n\n        const selector = document.querySelector(`#annotationwrapper #form`);\n        const decisionform = new DynamicForm(selector, self.prop.form);\n        decisionform.load(data);\n\n        self.onEditFormLoaded(decisionform);\n        self.validateTimestampFieldValue('timestampassist', 'timestamp');\n\n        $(document).off('click', '#cancel-submit').on('click', '#cancel-submit', function(e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            $('#annotationwrapper #form').remove();\n            $('#annotationwrapper table').show();\n            $('#addcontent, #importcontent').removeClass('no-pointer-events');\n        });\n\n        $(document).off('click', '#submitform-submit').on('click', '#submitform-submit', function(e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const event = decisionform.trigger(decisionform.events.SUBMIT_BUTTON_PRESSED);\n            if (!event.defaultPrevented) {\n                decisionform.submitFormAjax();\n            }\n        });\n\n        decisionform.addEventListener(decisionform.events.SERVER_VALIDATION_ERROR, (e) => {\n            e.stopImmediatePropagation();\n            self.onEditFormLoaded(decisionform);\n            self.validateTimestampFieldValue('timestampassist', 'timestamp');\n        });\n\n        decisionform.addEventListener(decisionform.events.FORM_SUBMITTED, (e) => {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            $.ajax({\n                url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n                method: \"POST\",\n                dataType: \"text\",\n                data: {\n                    action: 'get_item',\n                    id: e.detail.id,\n                    sesskey: M.cfg.sesskey,\n                    contextid: M.cfg.courseContextId,\n                    token: self.token,\n                    cmid: self.cm,\n                },\n                success: function(data) {\n                    const newAnnotation = JSON.parse(data);\n                    dispatchEvent('annotationupdated', {\n                        annotation: newAnnotation,\n                        action: 'add'\n                    });\n                }\n            });\n            $('#annotationwrapper #form').remove();\n            $('#annotationwrapper table').show();\n            $('#addcontent, #importcontent').removeClass('no-pointer-events');\n        });\n\n    }\n\n    /**\n     * Edit an annotation\n     * @param {Array} annotations The annotations array\n     * @param {number} id The annotation id\n     * @returns {void}\n     */\n    editAnnotation(annotations, id) {\n        // Disable pointer events on some DOMs.\n        $('#addcontent, #importcontent').addClass('no-pointer-events');\n        this.annotations = annotations;\n        let self = this;\n        const annotation = annotations.find(x => x.id == id);\n        const timestamp = annotation.timestamp;\n        const timestampassist = this.convertSecondsToHMS(timestamp);\n\n        annotation.timestampassist = timestampassist;\n        annotation.start = this.convertSecondsToHMS(this.start);\n        annotation.end = this.convertSecondsToHMS(this.end);\n        annotation.contextid = M.cfg.contextid;\n\n        $('#annotationwrapper table').hide();\n        $('#annotationwrapper').append('<div id=\"form\" class=\"w-100 p-3\"></div>');\n        const selector = document.querySelector(`#annotationwrapper #form`);\n        const decisionform = new DynamicForm(selector, self.prop.form);\n        decisionform.load(annotation);\n\n        self.onEditFormLoaded(decisionform);\n        self.validateTimestampFieldValue('timestampassist', 'timestamp');\n\n        $(document).off('click', '#cancel-submit').on('click', '#cancel-submit', function(e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            $('#annotationwrapper #form').remove();\n            $('#annotationwrapper table').show();\n            $('#addcontent, #importcontent').removeClass('no-pointer-events');\n        });\n\n        $(document).off('click', '#submitform-submit').on('click', '#submitform-submit', function(e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const event = decisionform.trigger(decisionform.events.SUBMIT_BUTTON_PRESSED);\n            if (!event.defaultPrevented) {\n                decisionform.submitFormAjax();\n            }\n        });\n\n        decisionform.addEventListener(decisionform.events.SERVER_VALIDATION_ERROR, (e) => {\n            e.stopImmediatePropagation();\n            self.onEditFormLoaded(decisionform);\n            self.validateTimestampFieldValue('timestampassist', 'timestamp');\n        });\n\n        decisionform.addEventListener(decisionform.events.FORM_SUBMITTED, (e) => {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            this.annotations = this.annotations.filter(x => x.id != id);\n            $.ajax({\n                url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n                method: \"POST\",\n                dataType: \"text\",\n                data: {\n                    action: 'get_item',\n                    id: e.detail.id,\n                    sesskey: M.cfg.sesskey,\n                    contextid: M.cfg.courseContextId,\n                    token: self.token,\n                    cmid: self.cm,\n                },\n            }).done(function(data) {\n                const updated = JSON.parse(data);\n                dispatchEvent('annotationupdated', {\n                    annotation: updated,\n                    action: 'edit'\n                });\n            });\n            $('#annotationwrapper #form').remove();\n            $('#annotationwrapper table').show();\n            $('#addcontent, #importcontent').removeClass('no-pointer-events');\n        });\n    }\n\n    /**\n     * Handles the loading of the edit form and initializes the destination list.\n     *\n     * @param {HTMLElement} form - The form element that is being edited.\n     * @param {Event} event - The event that triggered the form load.\n     * @returns {Object} An object containing the form and event.\n     */\n    onEditFormLoaded(form, event) {\n        let self = this;\n        let body = $('#annotationwrapper #form');\n\n        const checkContentField = () => {\n            if ($('[name=content]').length > 0) {\n                let dest = $('[name=content]').val();\n                if (dest == '' || JSON.parse(dest).length == 0) {\n                    $('#destination-list').append(`<div class=\"input-group mb-1 d-none\">\n                <div class=\"input-group-prepend\">\n                    <label class=\"input-group-text\">\n                    <i class=\"bi bi-grip-vertical fs-unset cursor-move\"></i></label>\n                </div>\n                <input type=\"text\" class=\"form-control\">\n                <input type=\"text\" value=\"${this.convertSecondsToHMS(this.start)}\"\n                placeholder=\"00:00:00\" style=\"max-width: 120px;\" class=\"form-control timestamp-input\">\n                <div class=\"input-group-append\">\n                <button class=\"btn goto-dest btn-secondary px-2\" type=\"button\"><i class=\"bi bi-play-fill fs-25px\"></i></button>\n                <button class=\"btn add-dest btn-secondary\" type=\"button\"><i class=\"bi bi-plus-lg fs-unset\"></i></button>\n                <button class=\"btn btn-danger delete-dest disabled\" disabled type=\"button\">\n                    <i class=\"bi bi-trash3-fill fs-unset\"></i></button></div></div>`);\n                } else {\n                    dest = JSON.parse(dest);\n                    dest.forEach((d, i) => {\n                        $('#destination-list').append(`<div class=\"input-group mb-1\">\n                    <div class=\"input-group-prepend\">\n                    <label class=\"input-group-text\">\n                    <i class=\"bi bi-grip-vertical cursor-move fs-unset\"></i></label>\n                    </div>\n                    <input type=\"text\" class=\"form-control\" value=\"${d.title}\">\n                    <input type=\"text\" value=\"${this.convertSecondsToHMS(d.timestamp)}\"\n                    placeholder=\"00:00:00\" style=\"max-width: 120px;\" class=\"form-control timestamp-input\">\n                    <div class=\"input-group-append\">\n                    <button class=\"btn goto-dest btn-secondary px-2\" type=\"button\"><i class=\"bi bi-play-fill fs-25px\"></i></button>\n                    <button class=\"btn add-dest btn-secondary\" type=\"button\"><i class=\"bi bi-plus-lg fs-unset\"></i></button>\n                    <button class=\"btn btn-danger delete-dest ${i == 0 ? 'disabled' : ''}\" ${i == 0 ? 'disabled' : ''}\n                    type=\"button\"><i class=\"bi bi-trash3-fill fs-unset\"></i></button></div></div>`);\n                    });\n                    $('.input-group [type=\"text\"]').trigger('input');\n                }\n\n                $('#destination-list').sortable({\n                    items: '.input-group',\n                    cursor: 'move',\n                    update: function() {\n                        $('.input-group [type=\"text\"]').trigger('input');\n                    },\n                    stop: function() {\n                        $('.input-group .delete-dest').removeAttr('disabled');\n                        $('.input-group .delete-dest').removeClass('disabled');\n                        $('.input-group .delete-dest').first().attr('disabled', true);\n                        $('.input-group .delete-dest').first().addClass('disabled');\n                    }\n                });\n            } else {\n                requestAnimationFrame(checkContentField);\n            }\n        };\n\n        requestAnimationFrame(checkContentField);\n\n        body.off('click', '#add-destination').on('click', '#add-destination', function() {\n            const $last = $('#destination-list .input-group').last();\n            $last.find('.add-dest').trigger('click');\n        });\n\n        body.off('click', '.input-group .add-dest').on('click', '.input-group .add-dest', async function(e) {\n            e.stopImmediatePropagation();\n            let $thisrow = $(this);\n            let $parent = $thisrow.closest('.input-group');\n            let $row = $parent.clone();\n            $row.removeClass('d-none');\n            $row.find('input').val('');\n            let currentTime = await self.player.getCurrentTime();\n            $row.find('input.timestamp-input').val(self.convertSecondsToHMS(currentTime));\n            $row.find('.delete-dest').removeClass('disabled').removeAttr('disabled');\n            $parent.after($row);\n            $parent.find('[type=\"text\"]').trigger('input');\n        });\n\n        body.off('click', '.input-group .delete-dest').on('click', '.input-group .delete-dest', function(e) {\n            e.stopImmediatePropagation();\n            $(this).closest('.input-group').remove();\n            $('.input-group [type=\"text\"]').trigger('input');\n        });\n\n        body.off('click', '.input-group .goto-dest').on('click', '.input-group .goto-dest', function(e) {\n            e.stopImmediatePropagation();\n            const timestamp = $(this).closest('.input-group').find('input.timestamp-input').val();\n            const parts = timestamp.split(':');\n            const seconds = Number(parts[0]) * 3600 + Number(parts[1]) * 60 + Number(parts[2]);\n            if (seconds >= self.start && seconds <= self.end) {\n                self.player.seek(seconds);\n            }\n        });\n\n        body.on('input', '.input-group [type=\"text\"]', function() {\n            let dest = [];\n            $('#destination-list .input-group').each(function() {\n                const title = $(this).find('input[type=\"text\"]');\n                const timestamp = $(this).find('.timestamp-input');\n                if (title.val() != '' && timestamp.val() != ''\n                    && !title.hasClass('is-invalid') && !timestamp.hasClass('is-invalid')) {\n                    const parts = timestamp.val().split(':');\n                    const seconds = Number(parts[0]) * 3600 + Number(parts[1]) * 60 + Number(parts[2]);\n                    dest.push({\n                        title: title.val(),\n                        timestamp: seconds\n                    });\n                }\n            });\n            if (dest.length == 0) {\n                $('[name=content').val('');\n            } else {\n                $('[name=content').val(JSON.stringify(dest));\n            }\n        });\n\n        return {form, event};\n    }\n\n    /**\n     * Run the interaction\n     * @param {object} annotation The annotation object\n     * @returns {void}\n     */\n    async runInteraction(annotation) {\n        // Dismiss all tooltips.\n        $('.tooltip').remove();\n        this.player.pause();\n        let self = this;\n        let dest = JSON.parse(annotation.content);\n        dest = dest.filter((d) => {\n            return !self.isSkipped(d.timestamp);\n        });\n\n        if (!self.isEditMode()) {\n            annotation.viewed = true;\n            this.annotations = this.annotations.filter((d) => d.id != annotation.id);\n            this.annotations.push(annotation);\n        }\n\n        if (dest.length == 0) {\n            window.console.log('No destination found');\n            this.player.play();\n            return;\n        }\n\n        let newannotation = JSON.parse(JSON.stringify(annotation));\n        newannotation.content = JSON.stringify(dest);\n        const data = await this.render(newannotation, 'json');\n        let $html = `<div class=\"position-absolute decision text-center mx-auto w-100\">\n            <h5 class=\"pt-5 pb-3 bg-white\" id=\"decision-q\">\n            <i class=\"mb-2 bi bi-signpost-split-fill\" style=\"font-size: 2em\"></i><br>${newannotation.formattedtitle}</h5>`;\n\n        data.forEach((dest, order) => {\n            $html += `<a href=\"javascript:void(0)\" data-timestamp=\"${dest.timestamp}\"\n                 data-order=\"${order}\" class=\"decision-option btn btn-outline-secondary btn-rounded mb-2 d-flex\n                  justify-content-between align-items-center mx-auto\"><span class=\"text-truncate\">${dest.title}</span>\n                  <i class=\"bi bi-chevron-right\"></i></a>`;\n        });\n        $html += '</div>';\n        let $message = $(`<div id=\"message\" style=\"z-index:1005;display:none;\" data-id=\"${annotation.id}\">\n            <div class=\"modal-body p-0 border\" id=\"content\">${$html}</div></div>`);\n        $('#video-wrapper').find(\"#message\").remove();\n        $('#video-wrapper').append($message);\n        $message.fadeIn(300, 'swing', function() {\n            if (annotation.char1 == 1) {\n                $message.append(`<button class=\"btn btn-secondary btn-rounded position-absolute\"\n                     id=\"close-decision\" style=\"right: 1rem; top: 1rem;\">\n                     ${M.util.get_string('skip', 'ivplugin_decision')}\n                     <i class=\"ml-2 bi bi-chevron-right\"></i></button>`);\n            }\n            $(document).off('click', '#close-decision').on('click', '#close-decision', function(e) {\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                self.player.play();\n                $('#taskinfo').fadeIn(300);\n                $('[data-region=\"chapterlists\"], #controller').removeClass('no-pointer-events');\n            });\n\n            if (!self.isEditMode()) {\n                $('#taskinfo').fadeOut(300);\n                $('[data-region=\"chapterlists\"], #controller').addClass('no-pointer-events');\n            }\n            self.player.pause();\n        });\n\n        $(document).off('click', `#message[data-id='${annotation.id}'] .decision-option`)\n            .on('click', `#message[data-id='${annotation.id}'] .decision-option`, function(e) {\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                let time = Number($(this).data('timestamp'));\n                if (time < this.start) {\n                    time = this.start;\n                } else if (time > this.end) {\n                    time = this.end;\n                }\n                self.player.seek(time);\n                $(`#message[data-id='${annotation.id}']`).fadeOut(300);\n                self.player.play();\n                $('#taskinfo').fadeIn(300);\n                $('[data-region=\"chapterlists\"], #controller').removeClass('no-pointer-events');\n            });\n    }\n}"],"names":["Decision","Base","init","this","isEditMode","decisions","annotations","filter","d","type","char1","length","self","document","on","e","cantSkip","viewed","sort","a","b","timestamp","t","Number","originalEvent","detail","time","firstCantSkip","player","seek","addAnnotation","coursemodule","addClass","isBetweenStartAndEnd","message","M","util","get_string","convertSecondsToHMS","start","end","addNotification","isAlreadyAdded","isInSkipSegment","startHMS","endHMS","timestampHMS","data","id","timestampassist","title","prop","contextid","cfg","name","courseid","course","cmid","annotationid","interaction","hascompletion","hide","append","modal","removeClass","selector","querySelector","decisionform","DynamicForm","form","load","onEditFormLoaded","validateTimestampFieldValue","off","preventDefault","stopImmediatePropagation","remove","show","trigger","events","SUBMIT_BUTTON_PRESSED","defaultPrevented","submitFormAjax","addEventListener","SERVER_VALIDATION_ERROR","FORM_SUBMITTED","ajax","url","wwwroot","method","dataType","action","sesskey","courseContextId","token","cm","success","newAnnotation","JSON","parse","annotation","editAnnotation","find","x","done","updated","event","body","checkContentField","dest","val","forEach","i","sortable","items","cursor","update","stop","removeAttr","first","attr","requestAnimationFrame","last","async","$parent","closest","$row","clone","currentTime","getCurrentTime","after","parts","split","seconds","each","hasClass","push","stringify","pause","content","isSkipped","window","console","log","play","newannotation","render","$html","formattedtitle","order","$message","fadeIn","fadeOut"],"mappings":"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"}