{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Main module for the decision plugin.\n *\n * @module     ivplugin_decision/main\n * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport $ from 'jquery';\nimport Base from 'mod_interactivevideo/type/base';\nimport DynamicForm from 'core_form/dynamicform';\nimport {dispatchEvent} from 'core/event_dispatcher';\nexport default class Decision extends Base {\n    /**\n     * Initializes the decision plugin for interactive videos.\n     *\n     * This method sets up event listeners and handles the logic for decision points\n     * within the video. If the video is not in edit mode, it filters out decision\n     * annotations and prevents skipping certain decision points based on their\n     * properties.\n     *\n     * @method init\n     * @memberof DecisionPlugin\n     * @instance\n     *\n     * @example\n     * // Initialize the decision plugin\n     * decisionPlugin.init();\n     */\n    init() {\n        if (!this.isEditMode()) {\n            const decisions = this.annotations.filter((d) => d.type == 'decision');\n            const notSkip = decisions.filter((d) => d.char1 != 1);\n            if (notSkip.length == 0) {\n                return;\n            }\n            var self = this;\n            $(document).on('timeupdate', function(e) {\n                const cantSkip = decisions.filter((d) => d.char1 != 1 && !d.viewed);\n                cantSkip.sort((a, b) => a.timestamp - b.timestamp);\n                if (cantSkip.length == 0) {\n                    return;\n                }\n                const t = Number(e.originalEvent.detail.time);\n                const firstCantSkip = cantSkip[0];\n                if (t > Number(firstCantSkip.timestamp)) {\n                    self.runInteraction(firstCantSkip);\n                }\n            });\n        }\n    }\n\n    /**\n     * Add an annotation\n     * @param {Array} annotations The annotations array\n     * @param {number} timestamp The timestamp\n     * @param {number} coursemodule The course module id\n     * @returns {void}\n     */\n    addAnnotation(annotations, timestamp, coursemodule) {\n        $('#addcontent, #interaction-timeline').addClass('no-pointer-events');\n        var self = this;\n        this.annotations = annotations;\n        if (!this.isBetweenStartAndEnd(timestamp)) {\n            var message = M.util.get_string('interactioncanonlybeaddedbetweenstartandendtime', 'mod_interactivevideo', {\n                \"start\": self.convertSecondsToHMS(self.start),\n                \"end\": self.convertSecondsToHMS(self.end),\n            });\n            self.addNotification(message);\n            return;\n        }\n\n        if (self.isAlreadyAdded(timestamp)) {\n            self.addNotification(M.util.get_string('interactionalreadyexists', 'mod_interactivevideo'));\n            return;\n        }\n\n        if (self.isInSkipSegment(timestamp)) {\n            self.addNotification(M.util.get_string('interactionisbetweentheskipsegment', 'mod_interactivevideo'));\n            return;\n        }\n\n        const startHMS = self.convertSecondsToHMS(self.start);\n        const endHMS = self.convertSecondsToHMS(self.end);\n        const timestampHMS = timestamp > 0 ? self.convertSecondsToHMS(timestamp) : startHMS;\n\n        const data = {\n            id: 0,\n            timestamp: timestamp > 0 ? timestamp : self.start,\n            timestampassist: timestampHMS,\n            title: self.prop.title,\n            start: startHMS,\n            end: endHMS,\n            contextid: M.cfg.contextid,\n            type: self.prop.name,\n            courseid: self.course,\n            cmid: coursemodule,\n            annotationid: self.interaction,\n            hascompletion: self.prop.hascompletion ? 1 : 0,\n        };\n\n        $('#annotationwrapper table').hide();\n        $('#annotationwrapper').append('<div id=\"form\" class=\"w-100 p-3\"></div>');\n        $(\"#contentmodal\").modal('hide');\n        $('#addcontentdropdown a').removeClass('active');\n\n        const selector = document.querySelector(`#annotationwrapper #form`);\n        const decisionform = new DynamicForm(selector, self.prop.form);\n        decisionform.load(data);\n\n        self.onEditFormLoaded(decisionform);\n        self.validateTimestampFieldValue('timestampassist', 'timestamp');\n\n        $(document).off('click', '#cancel-submit').on('click', '#cancel-submit', function(e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            $('#annotationwrapper #form').remove();\n            $('#annotationwrapper table').show();\n        });\n\n        $(document).off('click', '#submitform-submit').on('click', '#submitform-submit', function(e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const event = decisionform.trigger(decisionform.events.SUBMIT_BUTTON_PRESSED);\n            if (!event.defaultPrevented) {\n                decisionform.submitFormAjax();\n            }\n        });\n\n        decisionform.addEventListener(decisionform.events.FORM_SUBMITTED, (e) => {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            $.ajax({\n                url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n                method: \"POST\",\n                dataType: \"text\",\n                data: {\n                    action: 'get_item',\n                    id: e.detail.id,\n                    sesskey: M.cfg.sesskey,\n                    contextid: M.cfg.courseContextId,\n                    token: self.token,\n                    cmid: self.cm,\n                },\n                success: function(data) {\n                    var newAnnotation = JSON.parse(data);\n                    dispatchEvent('annotationupdated', {\n                        annotation: newAnnotation,\n                        action: 'add'\n                    });\n                }\n            });\n            $('#annotationwrapper #form').remove();\n            $('#annotationwrapper table').show();\n            $('#addcontent, #interaction-timeline').removeClass('no-pointer-events');\n        });\n\n    }\n\n    /**\n     * Edit an annotation\n     * @param {Array} annotations The annotations array\n     * @param {number} id The annotation id\n     * @returns {void}\n     */\n    editAnnotation(annotations, id) {\n        // Disable pointer events on some DOMs.\n        $('#addcontent, #interaction-timeline').addClass('no-pointer-events');\n        this.annotations = annotations;\n        let self = this;\n        const annotation = annotations.find(x => x.id == id);\n        const timestamp = annotation.timestamp;\n        const timestampassist = this.convertSecondsToHMS(timestamp);\n\n        annotation.timestampassist = timestampassist;\n        annotation.start = this.convertSecondsToHMS(this.start);\n        annotation.end = this.convertSecondsToHMS(this.end);\n        annotation.contextid = M.cfg.contextid;\n\n        $('#annotationwrapper table').hide();\n        $('#annotationwrapper').append('<div id=\"form\" class=\"w-100 p-3\"></div>');\n        const selector = document.querySelector(`#annotationwrapper #form`);\n        const decisionform = new DynamicForm(selector, self.prop.form);\n        decisionform.load(annotation);\n\n        self.onEditFormLoaded(decisionform);\n        self.validateTimestampFieldValue('timestampassist', 'timestamp');\n\n        $(document).off('click', '#cancel-submit').on('click', '#cancel-submit', function(e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            $('#annotationwrapper #form').remove();\n            $('#annotationwrapper table').show();\n        });\n\n        $(document).off('click', '#submitform-submit').on('click', '#submitform-submit', function(e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            const event = decisionform.trigger(decisionform.events.SUBMIT_BUTTON_PRESSED);\n            if (!event.defaultPrevented) {\n                decisionform.submitFormAjax();\n            }\n        });\n\n        decisionform.addEventListener(decisionform.events.FORM_SUBMITTED, (e) => {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            this.annotations = this.annotations.filter(x => x.id != id);\n            $.ajax({\n                url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n                method: \"POST\",\n                dataType: \"text\",\n                data: {\n                    action: 'get_item',\n                    id: e.detail.id,\n                    sesskey: M.cfg.sesskey,\n                    contextid: M.cfg.courseContextId,\n                    token: self.token,\n                    cmid: self.cm,\n                },\n            }).done(function(data) {\n                var updated = JSON.parse(data);\n                dispatchEvent('annotationupdated', {\n                    annotation: updated,\n                    action: 'edit'\n                });\n            });\n            $('#annotationwrapper #form').remove();\n            $('#annotationwrapper table').show();\n            $('#addcontent, #interaction-timeline').removeClass('no-pointer-events');\n        });\n    }\n\n    /**\n     * Handles the loading of the edit form and initializes the destination list.\n     *\n     * @param {HTMLElement} form - The form element that is being edited.\n     * @param {Event} event - The event that triggered the form load.\n     * @returns {Object} An object containing the form and event.\n     */\n    onEditFormLoaded(form, event) {\n        let self = this;\n        let body = $('#annotationwrapper #form');\n\n        const checkContentField = () => {\n            if ($('[name=content]').length > 0) {\n                var dest = $('[name=content]').val();\n                if (dest == '' || JSON.parse(dest).length == 0) {\n                    $('#destination-list').append(`<div class=\"input-group mb-1 d-none\">\n                <div class=\"input-group-prepend\">\n                    <label class=\"input-group-text\">\n                    <i class=\"bi bi-grip-vertical fs-unset cursor-move\"></i></label>\n                </div>\n                <input type=\"text\" class=\"form-control\">\n                <input type=\"text\" value=\"${this.convertSecondsToHMS(this.start)}\"\n                placeholder=\"00:00:00\" style=\"max-width: 120px;\" class=\"form-control timestamp-input\">\n                <div class=\"input-group-append\">\n                <button class=\"btn add-dest btn-secondary\" type=\"button\"><i class=\"bi bi-plus-lg fs-unset\"></i></button>\n                <button class=\"btn btn-danger delete-dest disabled\" disabled type=\"button\">\n                    <i class=\"bi bi-trash3-fill fs-unset\"></i></button></div></div>`);\n                } else {\n                    dest = JSON.parse(dest);\n                    dest.forEach((d, i) => {\n                        $('#destination-list').append(`<div class=\"input-group mb-1\">\n                    <div class=\"input-group-prepend\">\n                    <label class=\"input-group-text\">\n                    <i class=\"bi bi-grip-vertical cursor-move fs-unset\"></i></label>\n                </div>\n                    <input type=\"text\" class=\"form-control\" value=\"${d.title}\">\n                    <input type=\"text\" value=\"${this.convertSecondsToHMS(d.timestamp)}\"\n                    placeholder=\"00:00:00\" style=\"max-width: 120px;\" class=\"form-control timestamp-input\">\n                    <div class=\"input-group-append\">\n                    <button class=\"btn add-dest btn-secondary\" type=\"button\"><i class=\"bi bi-plus-lg fs-unset\"></i></button>\n                    <button class=\"btn btn-danger delete-dest ${i == 0 ? 'disabled' : ''}\" ${i == 0 ? 'disabled' : ''}\n                    type=\"button\"><i class=\"bi bi-trash3-fill fs-unset\"></i></button></div></div>`);\n                    });\n                    $('.input-group [type=\"text\"]').trigger('input');\n                }\n\n                $('#destination-list').sortable({\n                    items: '.input-group',\n                    cursor: 'move',\n                    update: function() {\n                        $('.input-group [type=\"text\"]').trigger('input');\n                    },\n                    stop: function() {\n                        $('.input-group .delete-dest').removeAttr('disabled');\n                        $('.input-group .delete-dest').removeClass('disabled');\n                        $('.input-group .delete-dest').first().attr('disabled', true);\n                        $('.input-group .delete-dest').first().addClass('disabled');\n                    }\n                });\n            } else {\n                requestAnimationFrame(checkContentField);\n            }\n        };\n\n        requestAnimationFrame(checkContentField);\n\n        body.off('click', '#add-destination').on('click', '#add-destination', function() {\n            const $last = $('#destination-list .input-group').last();\n            $last.find('.add-dest').trigger('click');\n        });\n\n        body.off('click', '.input-group .add-dest').on('click', '.input-group .add-dest', async function(e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            let $thisrow = $(this);\n            let $parent = $thisrow.closest('.input-group');\n            let $row = $parent.clone();\n            $row.removeClass('d-none');\n            $row.find('input').val('');\n            let currentTime = await self.player.getCurrentTime();\n            $row.find('input.timestamp-input').val(self.convertSecondsToHMS(currentTime));\n            $row.find('.delete-dest').removeClass('disabled').removeAttr('disabled');\n            $parent.after($row);\n            $parent.find('[type=\"text\"]').trigger('input');\n        });\n\n        body.off('click', '.input-group .delete-dest').on('click', '.input-group .delete-dest', function(e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            $(this).closest('.input-group').remove();\n            $('.input-group [type=\"text\"]').trigger('input');\n        });\n\n        body.on('input', '.input-group [type=\"text\"]', function() {\n            var dest = [];\n            $('#destination-list .input-group').each(function() {\n                var title = $(this).find('input[type=\"text\"]');\n                var timestamp = $(this).find('.timestamp-input');\n                if (title.val() != '' && timestamp.val() != ''\n                    && !title.hasClass('is-invalid') && !timestamp.hasClass('is-invalid')) {\n                    var parts = timestamp.val().split(':');\n                    var seconds = Number(parts[0]) * 3600 + Number(parts[1]) * 60 + Number(parts[2]);\n                    dest.push({\n                        title: title.val(),\n                        timestamp: seconds\n                    });\n                }\n            });\n            $('[name=content').val(JSON.stringify(dest));\n        });\n\n        return {form, event};\n    }\n\n    /**\n     * Run the interaction\n     * @param {object} annotation The annotation object\n     * @returns {void}\n     */\n    async runInteraction(annotation) {\n        // Dismiss all tooltips.\n        $('.tooltip').remove();\n        this.player.pause();\n        let self = this;\n        var dest = JSON.parse(annotation.content);\n        dest = dest.filter((d) => {\n            return !self.isSkipped(d.timestamp);\n        });\n\n        if (dest.length == 0) {\n            this.player.play();\n            return;\n        }\n\n        if (!self.isEditMode()) {\n            annotation.viewed = true;\n            this.annotations = this.annotations.filter((d) => d.id != annotation.id);\n            this.annotations.push(annotation);\n        }\n\n        let newannotation = JSON.parse(JSON.stringify(annotation));\n        newannotation.content = JSON.stringify(dest);\n        const data = await this.render(newannotation, 'json');\n        let $html = `<div class=\"position-absolute decision text-center mx-auto w-100\">\n            <h5 class=\"pt-5 pb-3 bg-white\" id=\"decision-q\">\n            <i class=\"mb-2 bi bi-signpost-split-fill\" style=\"font-size: 2em\"></i><br>${newannotation.formattedtitle}</h5>`;\n\n        data.forEach((dest, order) => {\n            $html += `<a href=\"javascript:void(0)\" data-timestamp=\"${dest.timestamp}\"\n                 data-order=\"${order}\" class=\"decision-option btn btn-outline-secondary btn-rounded mb-2 d-flex\n                  justify-content-between align-items-center mx-auto\"><span class=\"text-truncate\">${dest.title}</span>\n                  <i class=\"bi bi-chevron-right\"></i></a>`;\n        });\n        $html += '</div>';\n        let $message = $(`<div id=\"message\" style=\"z-index:1005;display:none;\" data-id=\"${annotation.id}\">\n            <div class=\"modal-body p-0 border\" id=\"content\">${$html}</div></div>`);\n        $('#video-wrapper').find(\"#message\").remove();\n        $('#video-wrapper').append($message);\n        $message.fadeIn(300, 'swing', function() {\n            if (annotation.char1 == 1) {\n                $message.append(`<button class=\"btn btn-secondary btn-rounded position-absolute\"\n                     id=\"close-decision\" style=\"right: 1rem; top: 1rem;\">\n                     ${M.util.get_string('skip', 'ivplugin_decision')}\n                     <i class=\"ml-2 bi bi-chevron-right\"></i></button>`);\n            }\n            $(document).off('click', '#close-decision').on('click', '#close-decision', function(e) {\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                self.player.play();\n                $('#taskinfo').fadeIn(300);\n                $('[data-region=\"chapterlists\"], #controller').removeClass('no-pointer-events');\n            });\n\n            if (!self.isEditMode()) {\n                $('#taskinfo').fadeOut(300);\n                $('[data-region=\"chapterlists\"], #controller').addClass('no-pointer-events');\n            }\n        });\n\n        $(document).off('click', `#message[data-id='${annotation.id}'] .decision-option`)\n            .on('click', `#message[data-id='${annotation.id}'] .decision-option`, function(e) {\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                var time = Number($(this).data('timestamp'));\n                if (time < this.start) {\n                    time = this.start;\n                } else if (time > this.end) {\n                    time = this.end;\n                }\n                self.player.seek(time);\n                $(`#message[data-id='${annotation.id}']`).fadeOut(300);\n                self.player.play();\n                $('#taskinfo').fadeIn(300);\n                $('[data-region=\"chapterlists\"], #controller').removeClass('no-pointer-events');\n            });\n    }\n}"],"names":["Decision","Base","init","this","isEditMode","decisions","annotations","filter","d","type","char1","length","self","document","on","e","cantSkip","viewed","sort","a","b","timestamp","t","Number","originalEvent","detail","time","firstCantSkip","runInteraction","addAnnotation","coursemodule","addClass","isBetweenStartAndEnd","message","M","util","get_string","convertSecondsToHMS","start","end","addNotification","isAlreadyAdded","isInSkipSegment","startHMS","endHMS","timestampHMS","data","id","timestampassist","title","prop","contextid","cfg","name","courseid","course","cmid","annotationid","interaction","hascompletion","hide","append","modal","removeClass","selector","querySelector","decisionform","DynamicForm","form","load","onEditFormLoaded","validateTimestampFieldValue","off","preventDefault","stopImmediatePropagation","remove","show","trigger","events","SUBMIT_BUTTON_PRESSED","defaultPrevented","submitFormAjax","addEventListener","FORM_SUBMITTED","ajax","url","wwwroot","method","dataType","action","sesskey","courseContextId","token","cm","success","newAnnotation","JSON","parse","annotation","editAnnotation","find","x","done","updated","event","body","checkContentField","dest","val","forEach","i","sortable","items","cursor","update","stop","removeAttr","first","attr","requestAnimationFrame","last","async","$parent","closest","$row","clone","currentTime","player","getCurrentTime","after","each","hasClass","parts","split","seconds","push","stringify","pause","content","isSkipped","play","newannotation","render","$html","formattedtitle","order","$message","fadeIn","fadeOut","seek"],"mappings":"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"}