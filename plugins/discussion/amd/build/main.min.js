define("ivplugin_discussion/main",["exports","mod_interactivevideo/type/base","jquery","core_filters/events"],(function(_exports,_base,_jquery,_events){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Main class for the discussion plugin.
   *
   * @module     ivplugin_discussion/main
   * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_base=_interopRequireDefault(_base),_jquery=_interopRequireDefault(_jquery);class Discussion extends _base.default{renderContainer(annotation){if(annotation.completiontracking&&"complete"==annotation.completiontracking&&((0,_jquery.default)(`#message[data-id='${annotation.id}'] #completiontoggle`).prop("disabled",!0),1==annotation.completed?(0,_jquery.default)(`#message[data-id='${annotation.id}'] #completiontoggle span`).text(`${M.util.get_string("completioncompleted","mod_interactivevideo")}`):(0,_jquery.default)(`#message[data-id='${annotation.id}'] #completiontoggle span`).text(`${M.util.get_string("completionincomplete","mod_interactivevideo")}`)),!this.isEditMode()){(0,_jquery.default)(`#message[data-id='${annotation.id}']`).find(".modal-body").addClass("p-0").css("height","100vh").html(`\n                <ul class="nav justify-content-center bg-light p-2 sticky-top" id="discussion-main">\n                    <li class="nav-item">\n                        <a class="nav-link active rounded-sm py-1" data-toggle="tab" href="#discussion-topic-${annotation.id}">\n                            ${M.util.get_string("discussiontopic","ivplugin_discussion")}\n                        </a>\n                    </li>\n                    <li class="nav-item">\n                        <a class="nav-link rounded-sm py-1" data-toggle="tab" href="#responses-${annotation.id}">\n                            ${M.util.get_string("responses","ivplugin_discussion")}\n                        </a>\n                    </li>\n                    <li class="nav-item">\n                        <a class="nav-link rounded-sm py-1" data-toggle="tab" href="#myresponses-${annotation.id}">\n                            ${M.util.get_string("myresponses","ivplugin_discussion")}\n                        </a>\n                    </li>\n                </ul>\n                <div class="tab-content">\n                    <div id="discussion-topic-${annotation.id}" class="tab-pane active">\n                        <div class="discussion">\n                        </div>\n                    </div>\n                    <div id="responses-${annotation.id}" class="tab-pane">\n                        <div class="responses p-3">\n                        <div class="table-responsive">\n                        <table class="table table-sm table-striped table-bordered table-hover">\n                        <thead>\n                        <tr>\n                        <th>${M.util.get_string("id","mod_interactivevideo")}</th>\n                        <th>${M.util.get_string("participant","mod_interactivevideo")}</th>\n                        <th>${M.util.get_string("timesubmitted","mod_interactivevideo")}</th>\n                        <th>${M.util.get_string("timemodified","mod_interactivevideo")}</th>\n                        <th>${M.util.get_string("replycount","ivplugin_discussion")}</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        </tbody>\n                        </table>\n                        </div>\n                        </div>\n                    </div>\n                    <div id="myresponses-${annotation.id}" class="tab-pane">\n                        <div class="myresponses">\n                        </div>\n                    </div>\n                </div>\n\n                `)}}postContentRender(annotation){(0,_jquery.default)(`#message[data-id='${annotation.id}'] .modal-body`).addClass("p-0"),(0,_jquery.default)(document).on("click",`#message[data-id='${annotation.id}'] #collapsetoggle`,(function(){(0,_jquery.default)(this).closest(".discussion-topic").toggleClass("collapsed expanded"),(0,_jquery.default)(this).find("i").toggleClass("bi-chevron-down bi-chevron-up")}))}runInteraction(annotation){const applyContent=annotation=>{this.render(annotation,"json").then((data=>{let $message=(0,_jquery.default)(`#message[data-id='${annotation.id}']`);$message.find(".modal-body").attr("id","content"),$message.find(`.modal-body #discussion-topic-${annotation.id}`).html(data.content);let $body=$message.find(".modal-body");(0,_events.notifyFilterContentUpdated)($body),this.postContentRender(annotation),this.interactionRunEvent(annotation,data)})).catch((()=>{}))};if(this.renderViewer(annotation).then((()=>{this.renderContainer(annotation),applyContent(annotation)})),this.enableManualCompletion(),"popup"==annotation.displayoptions){let self=this;(0,_jquery.default)("#annotation-modal").on("shown.bs.modal",(function(){self.setModalDraggable("#annotation-modal .modal-dialog")}))}}}return _exports.default=Discussion,_exports.default}));

//# sourceMappingURL=main.min.js.map