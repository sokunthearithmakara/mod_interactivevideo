{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Main class for the xpreward plugin\n *\n * @module     ivplugin_xpreward/main\n * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport Base from 'mod_interactivevideo/type/base';\n\nexport default class XpReward extends Base {\n    /**\n     * Render the container for the annotation\n     * @param {Object} annotation The annotation object\n     * @returns {void}\n     */\n    renderContainer(annotation) {\n        $('#video-wrapper #message').remove();\n        $('#video-wrapper').append(`<div id=\"message\" data-id=\"${annotation.id}\"\n             class=\"text-white bg-transparent\" style=\"z-index:5;\">\n            </div>`);\n    }\n\n    completionCallback(annotations, thisItem) {\n        $(`#message[data-id='${thisItem.id}'] #xpreward`).find('button').removeClass('btn-primary').addClass('btn-success');\n        setTimeout(() => {\n            this.player.play();\n        }, 1000);\n    }\n\n    postContentRender(annotation) {\n        var self = this;\n        $(document).on('click', `#message[data-id='${annotation.id}'] #xpreward`, function (e) {\n            e.preventDefault();\n            $(this).find('button').prop('disabled', true);\n            $(this).find('button').text(M.util.get_string('claimedxp', 'mod_interactivevideo', annotation.xp));\n\n            self.toggleCompletion(annotation.id, 'mark-done', 'automatic');\n        });\n    }\n\n    /**\n     * What happens when an item runs\n     * @param {Object} annotation The annotation object\n     * @returns {void}\n     */\n    runInteraction(annotation) {\n        this.renderContainer(annotation);\n        this.render(annotation).then((content) => {\n            let $message = $(`#message[data-id='${annotation.id}']`);\n            $message.html('<div class=\"modal-body d-flex align-items-center justify-content-center\">' + content + '</div>');\n            return this.postContentRender(annotation);\n        }).catch(() => {\n            // Do nothing.\n        });\n    }\n}"],"names":["XpReward","Base","renderContainer","annotation","remove","append","id","completionCallback","annotations","thisItem","find","removeClass","addClass","setTimeout","player","play","postContentRender","self","this","document","on","e","preventDefault","prop","text","M","util","get_string","xp","toggleCompletion","runInteraction","render","then","content","html","catch"],"mappings":";;;;;;;uKA0BqBA,iBAAiBC,cAMlCC,gBAAgBC,gCACV,2BAA2BC,6BAC3B,kBAAkBC,OAAQ,8BAA6BF,WAAWG,+FAKxEC,mBAAmBC,YAAaC,8BACzB,qBAAoBA,SAASH,kBAAkBI,KAAK,UAAUC,YAAY,eAAeC,SAAS,eACrGC,YAAW,UACFC,OAAOC,SACb,KAGPC,kBAAkBb,gBACVc,KAAOC,yBACTC,UAAUC,GAAG,QAAU,qBAAoBjB,WAAWG,kBAAkB,SAAUe,GAChFA,EAAEC,qCACAJ,MAAMR,KAAK,UAAUa,KAAK,YAAY,uBACtCL,MAAMR,KAAK,UAAUc,KAAKC,EAAEC,KAAKC,WAAW,YAAa,uBAAwBxB,WAAWyB,KAE9FX,KAAKY,iBAAiB1B,WAAWG,GAAI,YAAa,gBAS1DwB,eAAe3B,iBACND,gBAAgBC,iBAChB4B,OAAO5B,YAAY6B,MAAMC,WACX,mBAAG,qBAAoB9B,WAAWG,QACxC4B,KAAK,4EAA8ED,QAAU,UAC/Ff,KAAKF,kBAAkBb,eAC/BgC,OAAM"}