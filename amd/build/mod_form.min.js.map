{"version":3,"file":"mod_form.min.js","sources":["../src/mod_form.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Interactive Video module form\n *\n * @module     mod_interactivevideo/mod_form\n * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/notification', 'core_form/modalform', 'core/str'], function ($, notification, ModalForm, str) {\n    return {\n        'init': function (id, usercontextid) {\n            var totaltime, player;\n            var videowrapper = $('#video-wrapper');\n            var endinput = $('input[name=end]');\n            var startinput = $('input[name=start]');\n            var startassistinput = $('input[name=startassist');\n            var endassistinput = $('input[name=endassist');\n            var totaltimeinput = $('input[name=totaltime]');\n            var videourlinput = $('input[name=videourl]');\n            var sourceinput = $('input[name=source]');\n            var videoinput = $('input[name=video]');\n            var uploadfield = $(\"#fitem_id_upload\");\n            var deletefield = $(\"#fitem_id_delete\");\n            var videofile = $('input[name=videofile]');\n            var videotype = $('input[name=type]');\n            const convertSecondsToHMS = (s) => {\n                var hours = Math.floor(s / 3600);\n                var minutes = Math.floor((s - (hours * 3600)) / 60);\n                var seconds = s - (hours * 3600) - (minutes * 60);\n                seconds = Math.round(seconds * 100) / 100;\n\n                var result = (hours < 10 ? \"0\" + hours : hours);\n                result += \":\" + (minutes < 10 ? \"0\" + minutes : minutes);\n                result += \":\" + (seconds < 10 ? \"0\" + seconds : seconds);\n                return result;\n            };\n\n            const validateTimestamp = (string) => {\n                // Make sure the timestamp format is hh:mm:ss\n                var regex = /^([0-9]{2}):([0-5][0-9]):([0-5][0-9])$/;\n                if (!regex.test(string)) {\n                    return false;\n                }\n                return true;\n            };\n            const whenPlayerReady = function () {\n                videowrapper.show();\n                // Recalculate the ratio of the video\n                player.ratio().then((ratio) => {\n                    $(\"#video-wrapper\").css('padding-bottom', (1 / ratio) * 100 + '%');\n                });\n                player.getDuration().then(\n                    function (duration) {\n                        totaltime = Math.ceil(duration);\n                        totaltimeinput.val(totaltime);\n                        if (Number(endinput.val()) > 0 && Number(endinput.val()) > totaltime) {\n                            endinput.val(totaltime);\n                            endassistinput.val(convertSecondsToHMS(totaltime));\n                        }\n\n                        if (Number(startinput.val()) > 0 && Number(startinput.val()) > totaltime) {\n                            startinput.val(0);\n                            startassistinput.val('00:00:00');\n                        }\n\n                        if (endassistinput.val() == '00:00:00' || endassistinput.val() == '') {\n                            endassistinput.val(convertSecondsToHMS(totaltime));\n                            endinput.val(totaltime);\n                        }\n                        $(\"#videototaltime\").text(\"<= \" + convertSecondsToHMS(totaltime));\n                    }\n                );\n            };\n\n            $(document).on('iv:playerReady', function () {\n                whenPlayerReady();\n            });\n\n            $(document).on('iv:playerError', async function () {\n                let strings = await str.get_strings([\n                    { key: 'thereisanissueloadingvideo', component: 'mod_interactivevideo' },\n                ]);\n                videourlinput.addClass('is-invalid');\n                videourlinput.after('<div class=\"form-control-feedback invalid-feedback d-inline\">'\n                    + strings[0] + '</div>');\n            });\n\n            videourlinput.on('input', async function () {\n                videourlinput.removeClass('is-invalid');\n                videourlinput.next('.form-control-feedback').remove();\n                videotype.val('');\n                if (player) {\n                    player.destroy();\n                }\n                var url = $(this).val().trim();\n                if (url == '') {\n                    videowrapper.hide();\n                    return;\n                }\n                // Check if the video is a youtube video\n                var regex = /(?:https?:\\/\\/)?(?:www\\.)?(?:youtube\\.com|youtu\\.be)(?:\\/embed\\/|\\/watch\\?v=|\\/)([^\\/]+)/g;\n                var match = regex.exec(url);\n                if (match) {\n                    videowrapper.show();\n                    // Show loader while the video is loading\n                    videowrapper.html('<div id=\"player\" class=\"w-100\"></div>');\n                    videotype.val('yt');\n                    require(['mod_interactivevideo/player/yt'], function (VP) {\n                        player = new VP(url, 0, null, true, false, true);\n                    });\n                    return;\n                }\n\n                // Extract id from the URL\n                regex = /(?:https?:\\/\\/)?(?:www\\.)?(?:vimeo\\.com)\\/(?:channels\\/[A-Za-z0-9]+\\/|)([^\\/]+)/g;\n                match = regex.exec(url);\n                var vid = match ? match[1] : null;\n                if (vid) {\n                    url = 'https://vimeo.com/' + vid;\n                    videourlinput.val(url);\n\n                    // Show loader while the video is loading\n                    videowrapper.html('<div id=\"player\" class=\"w-100\"></div>');\n                    videotype.val('vimeo');\n                    require(['mod_interactivevideo/player/vimeo'], function (VP) {\n                        player = new VP(url, 0, null, true);\n                    });\n                    return;\n                }\n\n                // Check if the video is from daily motion.\n                regex = /(?:https?:\\/\\/)?(?:www\\.)?(?:dai\\.ly|dailymotion\\.com)\\/(?:embed\\/video\\/|video\\/|)([^\\/]+)/g;\n                match = regex.exec(url);\n                if (match) {\n                    videowrapper.show();\n                    // Show loader while the video is loading\n                    videowrapper.html('<div id=\"player\" class=\"w-100\"></div>');\n                    videotype.val('dailymotion');\n                    require(['mod_interactivevideo/player/dailymotion'], function (VP) {\n                        player = new VP(url, 0, null, true);\n                    });\n                    return;\n                }\n\n                // Check if the video is from wistia https://sokunthearithmakara.wistia.com/medias/0b3dgsil85\n                regex = /(?:https?:\\/\\/)?(?:www\\.)?(?:wistia\\.com)\\/medias\\/([^\\/]+)/g;\n                match = regex.exec(url);\n                var mediaId = match ? match[1] : null;\n                if (mediaId) {\n                    videowrapper.show();\n                    videotype.val('wistia');\n                    require(['mod_interactivevideo/player/wistia'], function (VP) {\n                        player = new VP(url, 0, null, true);\n                    });\n                    return;\n                }\n\n                // Check if the video is from panopto https://panopto.com/Panopto/Pages/Embed.aspx?id=1234567890\n\n\n                // Check if the link is a direct video link and video is \"canplay\"\n                const checkVideo = new Promise((resolve) => {\n                    // Remove video element if it exists\n                    if (document.querySelector('video')) {\n                        document.querySelector('video').remove();\n                    }\n                    var video = document.createElement('video');\n                    video.src = url;\n                    video.addEventListener('canplay', function () {\n                        resolve(true);\n                    });\n\n                    video.addEventListener('error', function () {\n                        resolve(false);\n                    });\n                });\n\n                if (await checkVideo) {\n                    // Show loader while the video is loading\n                    videowrapper.html('<video id=\"player\" class=\"w-100\"></video>');\n                    videotype.val('html5video');\n                    require(['mod_interactivevideo/player/html5video'], function (VP) {\n                        player = new VP(url, 0, null, true);\n                    });\n                    return;\n                }\n\n                // Invalid video url\n                str.get_strings([\n                    { key: 'invalidvideourl', component: 'mod_interactivevideo' },\n                    { key: 'error', component: 'core' }\n                ]).then(function (strings) {\n                    notification.alert(strings[1], strings[0]);\n                });\n                videowrapper.hide();\n            });\n\n            startassistinput.on('change', function () {\n                startassistinput.removeClass('is-invalid');\n                startassistinput.next('.form-control-feedback').remove();\n                if (startassistinput.val() == '') {\n                    return;\n                }\n                var startTimeStrings = str.get_strings([\n                    { key: 'starttimelesstotaltime', component: 'mod_interactivevideo' },\n                    { key: 'starttimelessthanendtime', component: 'mod_interactivevideo' },\n                    { key: 'invalidtimestampformat', component: 'mod_interactivevideo' },\n                ]);\n                startTimeStrings.then(function (strings) {\n                    if (!validateTimestamp(startassistinput.val())) {\n                        startassistinput.addClass('is-invalid');\n                        startassistinput.after('<div class=\"form-control-feedback invalid-feedback d-inline\">'\n                            + strings[2] + '</div>');\n                        startassistinput.val('00:00:00');\n                        return;\n                    }\n                    var parts = startassistinput.val().split(':');\n                    var time = parseInt(parts[0]) * 3600 + parseInt(parts[1]) * 60 + parseInt(parts[2]);\n                    startinput.val(time);\n                    if (Number(startinput.val()) > totaltime) {\n                        startassistinput.addClass('is-invalid');\n                        startassistinput.after('<div class=\"form-control-feedback invalid-feedback d-inline\">'\n                            + strings[0] + '</div>');\n                        startassistinput.val(convertSecondsToHMS(totaltime));\n                    } else {\n                        if (Number(endinput.val()) && Number(endinput.val()) != 0\n                            && Number(startinput.val()) > Number(endinput.val())) {\n                            startassistinput.addClass('is-invalid');\n                            startassistinput.after('<div class=\"form-control-feedback invalid-feedback d-inline\">'\n                                + strings[1] + '</div>');\n                            startassistinput.val(convertSecondsToHMS(endinput.val()));\n                        } else if (Number(startinput.val()) >= Number(endinput.val())) {\n                            endassistinput.val(convertSecondsToHMS(0));\n                        }\n                    }\n                });\n            });\n\n            endassistinput.on('change', function () {\n                endassistinput.removeClass('is-invalid');\n                endassistinput.next('.form-control-feedback').remove();\n                if (endassistinput.val() == '') {\n                    return;\n                }\n                var endTimeStrings = str.get_strings([\n                    { key: 'endtimelesstotaltime', component: 'mod_interactivevideo' },\n                    { key: 'endtimegreaterstarttime', component: 'mod_interactivevideo' },\n                    { key: 'invalidtimestampformat', component: 'mod_interactivevideo' },\n                ]);\n                endTimeStrings.then(function (strings) {\n                    if (!validateTimestamp(endassistinput.val())) {\n                        endassistinput.addClass('is-invalid');\n                        endassistinput.after('<div class=\"form-control-feedback invalid-feedback d-inline\">'\n                            + strings[2] + '</div>');\n                        endassistinput.val('00:00:00');\n                        return;\n                    }\n                    var parts = endassistinput.val().split(':');\n                    var time = parseInt(parts[0]) * 3600 + parseInt(parts[1]) * 60 + parseInt(parts[2]);\n                    endinput.val(time);\n                    if (Number(endinput.val()) > totaltime) {\n                        endassistinput.addClass('is-invalid');\n                        endassistinput.after('<div class=\"form-control-feedback invalid-feedback d-inline\">'\n                            + strings[0] + '</div>');\n                        endassistinput.val(convertSecondsToHMS(totaltime));\n                    } else {\n                        if (Number(startinput.val()) && Number(endinput.val()) < Number(startinput.val())) {\n                            endassistinput.addClass('is-invalid');\n                            endassistinput.after('<div class=\"form-control-feedback invalid-feedback d-inline\">'\n                                + strings[1] + '</div>');\n                            endassistinput.val(convertSecondsToHMS(startinput.val()));\n                        } else if (Number(startinput.val()) >= Number(endinput.val())) {\n                            endassistinput.val(convertSecondsToHMS(totaltime));\n                        }\n                    }\n                }\n                );\n            });\n\n            // Upload video to get draft item id\n            $(document).on('click', '#id_upload', function () {\n                var data = {\n                    contextid: M.cfg.contextid,\n                    id: id,\n                    usercontextid: usercontextid,\n                };\n\n                str.get_string('uploadvideo', 'mod_interactivevideo').then(function (string) {\n                    var form = new ModalForm({\n                        modalConfig: {\n                            title: string,\n                        },\n                        formClass: \"mod_interactivevideo\\\\form\\\\video_upload_form\",\n                        args: data,\n                    });\n\n                    form.show();\n\n                    form.addEventListener(form.events.FORM_SUBMITTED, async (e) => {\n                        var url = e.detail.url;\n                        videowrapper.html('<video id=\"player\" class=\"w-100\"></video>');\n                        require(['mod_interactivevideo/player/html5video'], function (VP) {\n                            player = new VP(url, 0, null, true);\n                        });\n                        videoinput.val(e.detail.video);\n                        // Hide the upload button.\n                        uploadfield.hide();\n                        // Show the delete button.\n                        deletefield.show();\n                    });\n                }).catch(() => {\n                    // Do nothing.\n                });\n            });\n\n            $(document).on('change', '#id_source', function () {\n                if ($(this).val() == 'file') {\n                    if (videoinput.val() == '' || videoinput.val() == '0') {\n                        uploadfield.show();\n                        deletefield.hide();\n                    } else {\n                        uploadfield.hide();\n                        deletefield.show();\n                    }\n                } else {\n                    uploadfield.hide();\n                    deletefield.hide();\n                }\n            });\n\n            $(document).on('click', '#id_delete', function () {\n                var deleteStrings = str.get_strings([\n                    { key: 'deletevideo', component: 'mod_interactivevideo' },\n                    { key: 'deletevideoconfirm', component: 'mod_interactivevideo' },\n                    { key: 'delete', component: 'mod_interactivevideo' },\n                ]);\n                deleteStrings.then(function (strings) {\n                    notification.saveCancel(\n                        strings[0],\n                        strings[1],\n                        strings[2],\n                        function () {\n                            videoinput.val('');\n                            videofile.val('');\n                            videowrapper.html(\"\").hide();\n                            uploadfield.show();\n                            deletefield.hide();\n                        });\n                });\n            });\n\n            // DOM ready\n            $(document).ready(function () {\n                setTimeout(function () {\n                    if (videourlinput.val() != '') {\n                        videourlinput.trigger('input');\n                        uploadfield.hide();\n                        deletefield.hide();\n                    }\n                    if (sourceinput.val() == 'url') {\n                        uploadfield.hide();\n                        deletefield.hide();\n                    } else {\n                        if (videoinput.val() != '' && videoinput.val() != '0') {\n                            uploadfield.hide();\n                            deletefield.show();\n                            var url = videofile.val();\n                            videowrapper.html('<video id=\"player\" class=\"w-100\"></video>');\n                            require(['mod_interactivevideo/player/html5video'], function (VP) {\n                                player = new VP(url, 0, null, true);\n                            });\n                        } else {\n                            uploadfield.show();\n                            deletefield.hide();\n                        }\n                    }\n\n                    if ($('[name=completionunlocked]').val() == '0') {\n                        $('#warning').removeClass('d-none');\n                        $('[name=videourl], [name=startassist], [name=endassist]').prop('readonly', 'true');\n                        $('#fitem_id_source, #fitem_id_delete, #fitem_id_upload').hide();\n                        $('#id_upload').prop('disabled', 'true');\n                        $('#id_delete').prop('disabled', 'true');\n                    }\n                }, 1000);\n            });\n\n            startassistinput.val(convertSecondsToHMS(startinput.val()));\n            endassistinput.val(convertSecondsToHMS(endinput.val()));\n\n        }\n    };\n});"],"names":["define","$","notification","ModalForm","str","id","usercontextid","totaltime","player","videowrapper","endinput","startinput","startassistinput","endassistinput","totaltimeinput","videourlinput","sourceinput","videoinput","uploadfield","deletefield","videofile","videotype","convertSecondsToHMS","s","hours","Math","floor","minutes","seconds","result","round","validateTimestamp","string","test","document","on","show","ratio","then","css","getDuration","duration","ceil","val","Number","text","async","strings","get_strings","key","component","addClass","after","removeClass","next","remove","destroy","url","this","trim","hide","regex","match","exec","html","require","VP","vid","checkVideo","Promise","resolve","querySelector","video","createElement","src","addEventListener","alert","parts","split","time","parseInt","data","contextid","M","cfg","get_string","form","modalConfig","title","formClass","args","events","FORM_SUBMITTED","e","detail","catch","saveCancel","ready","setTimeout","trigger","prop"],"mappings":"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"}