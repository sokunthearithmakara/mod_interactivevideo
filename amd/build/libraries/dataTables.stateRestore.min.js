!function(factory){if("function"==typeof define&&define.amd)define("mod_interactivevideo/libraries/dataTables.stateRestore",["jquery","mod_interactivevideo/libraries/datatables"],(function($){return factory($,window,document)}));else if("object"==typeof exports){var jq=require("jquery"),cjsRequires=function(root,$){$.fn.dataTable||require("mod_interactivevideo/libraries/datatables")(root,$)};"undefined"==typeof window?module.exports=function(root,$){return root||(root=window),$||($=jq(root)),cjsRequires(root,$),factory($,root,root.document)}:(cjsRequires(window,jq),module.exports=factory(jq,window,window.document))}else factory(jQuery,window,document)}((function($,window,document){var DataTable=$.fn.dataTable;return function(){var $$2,dataTable$1;var $$1,dataTable,StateRestore=function(){function StateRestore(settings,opts,identifier,state,isPreDefined,successCallback){if(void 0===state&&(state=void 0),void 0===isPreDefined&&(isPreDefined=!1),void 0===successCallback&&(successCallback=function(){return null}),!dataTable$1||!dataTable$1.versionCheck||!dataTable$1.versionCheck("1.10.0"))throw new Error("StateRestore requires DataTables 1.10 or newer");if(!dataTable$1.Buttons)throw new Error("StateRestore requires Buttons");var table=new dataTable$1.Api(settings);this.classes=$$2.extend(!0,{},StateRestore.classes),this.c=$$2.extend(!0,{},StateRestore.defaults,opts),this.s={dt:table,identifier:identifier,isPreDefined:isPreDefined,savedState:null,tableId:state&&state.stateRestore?state.stateRestore.tableId:void 0},this.dom={background:$$2('<div class="'+this.classes.background+'"/>'),closeButton:$$2('<div class="'+this.classes.closeButton+'">&times;</div>'),confirmation:$$2('<div class="'+this.classes.confirmation+'"/>'),confirmationButton:$$2('<button class="'+this.classes.confirmationButton+" "+this.classes.dtButton+'">'),confirmationTitleRow:$$2('<div class="'+this.classes.confirmationTitleRow+'"></div>'),dtContainer:$$2(this.s.dt.table().container()),duplicateError:$$2('<span class="'+this.classes.modalError+'">'+this.s.dt.i18n("stateRestore.duplicateError",this.c.i18n.duplicateError)+"</span>"),emptyError:$$2('<span class="'+this.classes.modalError+'">'+this.s.dt.i18n("stateRestore.emptyError",this.c.i18n.emptyError)+"</span>"),removeContents:$$2('<div class="'+this.classes.confirmationText+'"><span>'+this.s.dt.i18n("stateRestore.removeConfirm",this.c.i18n.removeConfirm).replace(/%s/g,StateRestore.entityEncode(this.s.identifier))+"</span></div>"),removeError:$$2('<span class="'+this.classes.modalError+'">'+this.s.dt.i18n("stateRestore.removeError",this.c.i18n.removeError)+"</span>"),removeTitle:$$2('<h2 class="'+this.classes.confirmationTitle+'">'+this.s.dt.i18n("stateRestore.removeTitle",this.c.i18n.removeTitle)+"</h2>"),renameContents:$$2('<div class="'+this.classes.confirmationText+" "+this.classes.renameModal+'"><label class="'+this.classes.confirmationMessage+'">'+this.s.dt.i18n("stateRestore.renameLabel",this.c.i18n.renameLabel).replace(/%s/g,StateRestore.entityEncode(this.s.identifier))+"</label></div>"),renameInput:$$2('<input class="'+this.classes.input+'" type="text"></input>'),renameTitle:$$2('<h2 class="'+this.classes.confirmationTitle+'">'+this.s.dt.i18n("stateRestore.renameTitle",this.c.i18n.renameTitle)+"</h2>")},this.save(state,successCallback)}return StateRestore.prototype.remove=function(skipModal){var _a,removeFunction,_this=this;if(void 0===skipModal&&(skipModal=!1),!this.c.remove)return!1;var ajaxData={action:"remove",stateRestore:(_a={},_a[this.s.identifier]=this.s.savedState,_a)},successCallback=function(){_this.dom.confirmation.trigger("dtsr-remove"),$$2(_this.s.dt.table().node()).trigger("stateRestore-change"),_this.dom.background.click(),_this.dom.confirmation.remove(),$$2(document).unbind("keyup",(function(e){return _this._keyupFunction(e)})),_this.dom.confirmationButton.off("click")};return this.c.ajax?"string"==typeof this.c.ajax&&this.s.dt.settings()[0]._bInitComplete?removeFunction=function(){return $$2.ajax({data:ajaxData,success:successCallback,type:"POST",url:_this.c.ajax}),!0}:"function"==typeof this.c.ajax&&(removeFunction=function(){return"function"==typeof _this.c.ajax&&_this.c.ajax.call(_this.s.dt,ajaxData,successCallback),!0}):removeFunction=function(){try{localStorage.removeItem("DataTables_stateRestore_"+_this.s.identifier+"_"+location.pathname+(_this.s.tableId?"_"+_this.s.tableId:"")),successCallback()}catch(e){return _this.dom.confirmation.children("."+_this.classes.modalError).remove(),_this.dom.confirmation.append(_this.dom.removeError),"remove"}return!0},skipModal?(this.dom.confirmation.appendTo(this.dom.dtContainer),$$2(this.s.dt.table().node()).trigger("dtsr-modal-inserted"),removeFunction(),this.dom.confirmation.remove()):this._newModal(this.dom.removeTitle,this.s.dt.i18n("stateRestore.removeSubmit",this.c.i18n.removeSubmit),removeFunction,this.dom.removeContents),!0},StateRestore.prototype.compare=function(state){if(this.c.saveState.order||(state.order=void 0),this.c.saveState.search||(state.search=void 0),this.c.saveState.columns&&state.columns)for(var i=0,ien=state.columns.length;i<ien;i++)"boolean"==typeof this.c.saveState.columns||this.c.saveState.columns.visible||(state.columns[i].visible=void 0),"boolean"==typeof this.c.saveState.columns||this.c.saveState.columns.search||(state.columns[i].search=void 0);else this.c.saveState.columns||(state.columns=void 0);this.c.saveState.paging||(state.page=void 0),this.c.saveState.searchBuilder||(state.searchBuilder=void 0),this.c.saveState.searchPanes||(state.searchPanes=void 0),this.c.saveState.select||(state.select=void 0),this.c.saveState.colReorder||(state.ColReorder=void 0),this.c.saveState.scroller||(state.scroller=void 0,void 0!==dataTable$1.Scroller&&(state.start=0)),this.c.saveState.paging||(state.start=0),this.c.saveState.length||(state.length=void 0),delete state.time;var copyState=this.s.savedState;return delete copyState.time,delete copyState.c,delete copyState.stateRestore,this._deepCompare(state,copyState)},StateRestore.prototype.destroy=function(){$$2.each(this.dom,(function(name,el){el.off().remove()}))},StateRestore.prototype.load=function(){var _this=this,loadedState=this.s.savedState,settings=this.s.dt.settings()[0];loadedState.time=+new Date,settings.oLoadedState=$$2.extend(!0,{},loadedState),$$2("div.dt-button-background").click();var loaded=function(){_this.s.dt.one("preDraw",(function(e,preSettings){setTimeout((function(){var currpage=preSettings._iDisplayStart/preSettings._iDisplayLength,intendedPage=loadedState.start/loadedState.length;currpage>=0&&intendedPage>=0&&currpage!==intendedPage&&_this.s.dt.page(intendedPage).draw(!1)}),50)})),_this.s.dt.draw(!1)};return DataTable.versionCheck("2")?(this.s.dt.state(loadedState),loaded()):DataTable.ext.oApi._fnImplementState(settings,loadedState,loaded),loadedState},StateRestore.prototype.rename=function(newIdentifier,currentIdentifiers){var _this=this;if(void 0===newIdentifier&&(newIdentifier=null),this.c.rename){var renameFunction=function(){var _a;if(null===newIdentifier){var tempIdentifier=$$2("input."+_this.classes.input.replace(/ /g,".")).val();if(0===tempIdentifier.length)return _this.dom.confirmation.children("."+_this.classes.modalError).remove(),_this.dom.confirmation.append(_this.dom.emptyError),"empty";if(currentIdentifiers.includes(tempIdentifier))return _this.dom.confirmation.children("."+_this.classes.modalError).remove(),_this.dom.confirmation.append(_this.dom.duplicateError),"duplicate";newIdentifier=tempIdentifier}var ajaxData={action:"rename",stateRestore:(_a={},_a[_this.s.identifier]=newIdentifier,_a)},successCallback=function(){_this.s.identifier=newIdentifier,_this.save(_this.s.savedState,(function(){return null}),!1),_this.dom.removeContents=$$2('<div class="'+_this.classes.confirmationText+'"><span>'+_this.s.dt.i18n("stateRestore.removeConfirm",_this.c.i18n.removeConfirm).replace(/%s/g,_this.s.identifier)+"</span></div>"),_this.dom.confirmation.trigger("dtsr-rename"),_this.dom.background.click(),_this.dom.confirmation.remove(),$$2(document).unbind("keyup",(function(e){return _this._keyupFunction(e)})),_this.dom.confirmationButton.off("click")};if(_this.c.ajax)"string"==typeof _this.c.ajax&&_this.s.dt.settings()[0]._bInitComplete?$$2.ajax({data:ajaxData,success:successCallback,type:"POST",url:_this.c.ajax}):"function"==typeof _this.c.ajax&&_this.c.ajax.call(_this.s.dt,ajaxData,successCallback);else try{localStorage.removeItem("DataTables_stateRestore_"+_this.s.identifier+"_"+location.pathname+(_this.s.tableId?"_"+_this.s.tableId:"")),successCallback()}catch(e){return _this.dom.confirmation.children("."+_this.classes.modalError).remove(),_this.dom.confirmation.append(_this.dom.removeError),!1}return!0};if(null!==newIdentifier){if(currentIdentifiers.includes(newIdentifier))throw new Error(this.s.dt.i18n("stateRestore.duplicateError",this.c.i18n.duplicateError));if(0===newIdentifier.length)throw new Error(this.s.dt.i18n("stateRestore.emptyError",this.c.i18n.emptyError));this.dom.confirmation.appendTo(this.dom.dtContainer),$$2(this.s.dt.table().node()).trigger("dtsr-modal-inserted"),renameFunction(),this.dom.confirmation.remove()}else this.dom.renameInput.val(this.s.identifier),this.dom.renameContents.append(this.dom.renameInput),this._newModal(this.dom.renameTitle,this.s.dt.i18n("stateRestore.renameButton",this.c.i18n.renameButton),renameFunction,this.dom.renameContents)}},StateRestore.prototype.save=function(state,passedSuccessCallback,callAjax){var _a,_this=this;if(void 0===callAjax&&(callAjax=!0),this.c.save){var savedState;if(this.s.dt.state.save(),void 0===state)savedState=this.s.dt.state();else{if("object"!=typeof state)return;savedState=state}if(savedState.stateRestore?(savedState.stateRestore.isPreDefined=this.s.isPreDefined,savedState.stateRestore.state=this.s.identifier,savedState.stateRestore.tableId=this.s.tableId):savedState.stateRestore={isPreDefined:this.s.isPreDefined,state:this.s.identifier,tableId:this.s.tableId},this.s.savedState=savedState,this.c.saveState.order||(this.s.savedState.order=void 0),this.c.saveState.search||(this.s.savedState.search=void 0),this.c.saveState.columns&&this.s.savedState.columns)for(var i=0,ien=this.s.savedState.columns.length;i<ien;i++)"boolean"==typeof this.c.saveState.columns||this.c.saveState.columns.visible||(this.s.savedState.columns[i].visible=void 0),"boolean"==typeof this.c.saveState.columns||this.c.saveState.columns.search||(this.s.savedState.columns[i].search=void 0);else this.c.saveState.columns||(this.s.savedState.columns=void 0);if(this.c.saveState.searchBuilder||(this.s.savedState.searchBuilder=void 0),this.c.saveState.searchPanes||(this.s.savedState.searchPanes=void 0),this.c.saveState.select||(this.s.savedState.select=void 0),this.c.saveState.colReorder||(this.s.savedState.ColReorder=void 0),this.c.saveState.scroller||(this.s.savedState.scroller=void 0,void 0!==dataTable$1.Scroller&&(this.s.savedState.start=0)),this.c.saveState.paging||(this.s.savedState.start=0),this.c.saveState.length||(this.s.savedState.length=void 0),this.s.savedState.c=this.c,this.s.savedState.c.splitSecondaries.length)for(var _i=0,_b=this.s.savedState.c.splitSecondaries;_i<_b.length;_i++){var secondary=_b[_i];secondary.parent&&(secondary.parent=void 0)}if(this.s.isPreDefined)passedSuccessCallback&&passedSuccessCallback.call(this);else{var ajaxData={action:"save",stateRestore:(_a={},_a[this.s.identifier]=this.s.savedState,_a)},successCallback=function(){passedSuccessCallback&&passedSuccessCallback.call(_this),_this.dom.confirmation.trigger("dtsr-save"),$$2(_this.s.dt.table().node()).trigger("stateRestore-change")};this.c.ajax?"string"==typeof this.c.ajax&&callAjax?this.s.dt.settings()[0]._bInitComplete?$$2.ajax({data:ajaxData,success:successCallback,type:"POST",url:this.c.ajax}):this.s.dt.one("init",(function(){$$2.ajax({data:ajaxData,success:successCallback,type:"POST",url:_this.c.ajax})})):"function"==typeof this.c.ajax&&callAjax&&this.c.ajax.call(this.s.dt,ajaxData,successCallback):(localStorage.setItem("DataTables_stateRestore_"+this.s.identifier+"_"+location.pathname+(this.s.tableId?"_"+this.s.tableId:""),JSON.stringify(this.s.savedState)),successCallback())}}else passedSuccessCallback&&passedSuccessCallback.call(this)},StateRestore.entityEncode=function(d){return"string"==typeof d?d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):d},StateRestore.prototype._deepCompare=function(state1,state2){var startIdx,i,states=[state1,state2],keys=[Object.keys(state1).sort(),Object.keys(state2).sort()];for(keys[0].includes("scroller")&&(startIdx=keys[0].indexOf("start"))&&keys[0].splice(startIdx,1),keys[1].includes("scroller")&&(startIdx=keys[1].indexOf("start"))&&keys[1].splice(startIdx,1),i=0;i<keys[0].length;i++)0!==keys[0][i].indexOf("_")?("baseRowTop"===keys[0][i]||"baseScrollTop"===keys[0][i]||"scrollTop"===keys[0][i]||!this.c.saveState.paging&&"page"===keys[0][i])&&(keys[0].splice(i,1),i--):(keys[0].splice(i,1),i--);for(i=0;i<keys[1].length;i++)0!==keys[1][i].indexOf("_")?("baseRowTop"===keys[1][i]||"baseScrollTop"===keys[1][i]||"scrollTop"===keys[1][i]||!this.c.saveState.paging&&"page"===keys[0][i])&&(keys[1].splice(i,1),i--):(keys[1].splice(i,1),i--);if(0===keys[0].length&&keys[1].length>0||0===keys[1].length&&keys[0].length>0)return!1;for(i=0;i<keys[0].length;i++)keys[1].includes(keys[0][i])||(keys[0].splice(i,1),i--);for(i=0;i<keys[1].length;i++)keys[0].includes(keys[1][i])||(keys[1].splice(i,1),i--);for(i=0;i<keys[0].length;i++){if(keys[0][i]!==keys[1][i]||typeof states[0][keys[0][i]]!=typeof states[1][keys[1][i]])return!1;if("object"==typeof states[0][keys[0][i]]){if(!this._deepCompare(states[0][keys[0][i]],states[1][keys[1][i]]))return!1}else if("number"==typeof states[0][keys[0][i]]&&"number"==typeof states[1][keys[1][i]]){if(Math.round(states[0][keys[0][i]])!==Math.round(states[1][keys[1][i]]))return!1}else if(states[0][keys[0][i]]!==states[1][keys[1][i]])return!1}return!0},StateRestore.prototype._keyupFunction=function(e){"Enter"===e.key?this.dom.confirmationButton.click():"Escape"===e.key&&$$2("div."+this.classes.background.replace(/ /g,".")).click()},StateRestore.prototype._newModal=function(title,buttonText,buttonAction,modalContents){var _this=this;this.dom.background.appendTo(this.dom.dtContainer),this.dom.confirmationTitleRow.empty().append(title),this.dom.confirmationButton.html(buttonText),this.dom.confirmation.empty().append(this.dom.confirmationTitleRow).append(modalContents).append($$2('<div class="'+this.classes.confirmationButtons+'"></div>').append(this.dom.confirmationButton)).appendTo(this.dom.dtContainer),$$2(this.s.dt.table().node()).trigger("dtsr-modal-inserted");var inputs=modalContents.children("input");inputs.length>0?$$2(inputs[0]).focus():this.dom.confirmationButton.focus();var background=$$2("div."+this.classes.background.replace(/ /g,"."));this.c.modalCloseButton&&(this.dom.confirmation.append(this.dom.closeButton),this.dom.closeButton.on("click",(function(){return background.click()}))),this.dom.confirmationButton.on("click",(function(){return buttonAction()})),this.dom.confirmation.on("click",(function(e){e.stopPropagation()})),background.one("click",(function(){_this.dom.background.remove(),_this.dom.confirmation.remove(),$$2(document).unbind("keyup",(function(e){return _this._keyupFunction(e)}))})),$$2(document).on("keyup",(function(e){return _this._keyupFunction(e)}))},StateRestore.version="1.4.1",StateRestore.classes={background:"dtsr-background",closeButton:"dtsr-popover-close",confirmation:"dtsr-confirmation",confirmationButton:"dtsr-confirmation-button",confirmationButtons:"dtsr-confirmation-buttons",confirmationMessage:"dtsr-confirmation-message dtsr-name-label",confirmationText:"dtsr-confirmation-text",confirmationTitle:"dtsr-confirmation-title",confirmationTitleRow:"dtsr-confirmation-title-row",dtButton:"dt-button",input:"dtsr-input",modalError:"dtsr-modal-error",renameModal:"dtsr-rename-modal"},StateRestore.defaults={_createInSaved:!1,ajax:!1,create:!0,creationModal:!1,i18n:{creationModal:{button:"Create",colReorder:"Column Order:",columns:{search:"Column Search:",visible:"Column Visibility:"},length:"Page Length:",name:"Name:",order:"Sorting:",paging:"Paging:",scroller:"Scroll Position:",search:"Search:",searchBuilder:"SearchBuilder:",searchPanes:"SearchPanes:",select:"Select:",title:"Create New State",toggleLabel:"Includes:"},duplicateError:"A state with this name already exists.",emptyError:"Name cannot be empty.",emptyStates:"No saved states",removeConfirm:"Are you sure you want to remove %s?",removeError:"Failed to remove state.",removeJoiner:" and ",removeSubmit:"Remove",removeTitle:"Remove State",renameButton:"Rename",renameLabel:"New Name for %s:",renameTitle:"Rename State"},modalCloseButton:!0,remove:!0,rename:!0,save:!0,saveState:{colReorder:!0,columns:{search:!0,visible:!0},length:!0,order:!0,paging:!0,scroller:!0,search:!0,searchBuilder:!0,searchPanes:!0,select:!0},splitSecondaries:["updateState","renameState","removeState"],toggle:{colReorder:!1,columns:{search:!1,visible:!1},length:!1,order:!1,paging:!1,scroller:!1,search:!1,searchBuilder:!1,searchPanes:!1,select:!1}},StateRestore}();var jq,StateRestoreCollection=function(){function StateRestoreCollection(settings,opts){var _this=this;if(!dataTable||!dataTable.versionCheck||!dataTable.versionCheck("1.10.0"))throw new Error("StateRestore requires DataTables 1.10 or newer");if(!dataTable.Buttons)throw new Error("StateRestore requires Buttons");var table=new dataTable.Api(settings);if(this.classes=$$1.extend(!0,{},StateRestoreCollection.classes),void 0===table.settings()[0]._stateRestore){var ajaxFunction;this.c=$$1.extend(!0,{},StateRestoreCollection.defaults,opts),this.s={dt:table,hasColReorder:void 0!==dataTable.ColReorder,hasScroller:void 0!==dataTable.Scroller,hasSearchBuilder:void 0!==dataTable.SearchBuilder,hasSearchPanes:void 0!==dataTable.SearchPanes,hasSelect:void 0!==dataTable.select,states:[]},this.s.dt.on("xhr",(function(e,xhrsettings,json){json&&json.stateRestore&&_this._addPreDefined(json.stateRestore)})),this.dom={background:$$1('<div class="'+this.classes.background+'"/>'),checkboxInputRow:$$1('<div class="'+this.classes.formRow+'"><label class="'+this.classes.nameLabel+'">'+this.s.dt.i18n("stateRestore.creationModal.toggleLabel",this.c.i18n.creationModal.toggleLabel)+'</label><div class="dtsr-input"></div></div>'),closeButton:$$1('<div class="'+this.classes.closeButton+'">x</div>'),colReorderToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.colReorderToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.colReorder",this.c.i18n.creationModal.colReorder)+"</div>"),columnsSearchToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.columnsSearchToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.columns.search",this.c.i18n.creationModal.columns.search)+"</div>"),columnsVisibleToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.columnsVisibleToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.columns.visible",this.c.i18n.creationModal.columns.visible)+"</div>"),confirmation:$$1('<div class="'+this.classes.confirmation+'"/>'),confirmationTitleRow:$$1('<div class="'+this.classes.confirmationTitleRow+'"></div>'),createButtonRow:$$1('<div class="'+this.classes.formRow+" "+this.classes.modalFoot+'"><button class="'+this.classes.creationButton+" "+this.classes.dtButton+'">'+this.s.dt.i18n("stateRestore.creationModal.button",this.c.i18n.creationModal.button)+"</button></div>"),creation:$$1('<div class="'+this.classes.creation+'"/>'),creationForm:$$1('<div class="'+this.classes.creationForm+'"/>'),creationTitle:$$1('<div class="'+this.classes.creationText+'"><h2 class="'+this.classes.creationTitle+'">'+this.s.dt.i18n("stateRestore.creationModal.title",this.c.i18n.creationModal.title)+"</h2></div>"),dtContainer:$$1(this.s.dt.table().container()),duplicateError:$$1('<span class="'+this.classes.modalError+'">'+this.s.dt.i18n("stateRestore.duplicateError",this.c.i18n.duplicateError)+"</span>"),emptyError:$$1('<span class="'+this.classes.modalError+'">'+this.s.dt.i18n("stateRestore.emptyError",this.c.i18n.emptyError)+"</span>"),lengthToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.lengthToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.length",this.c.i18n.creationModal.length)+"</div>"),nameInputRow:$$1('<div class="'+this.classes.formRow+'"><label class="'+this.classes.nameLabel+'">'+this.s.dt.i18n("stateRestore.creationModal.name",this.c.i18n.creationModal.name)+'</label><div class="dtsr-input"><input class="'+this.classes.nameInput+'" type="text"></div></div>'),orderToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.orderToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.order",this.c.i18n.creationModal.order)+"</div>"),pagingToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.pagingToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.paging",this.c.i18n.creationModal.paging)+"</div>"),removeContents:$$1('<div class="'+this.classes.confirmationText+'"><span></span></div>'),removeTitle:$$1('<div class="'+this.classes.creationText+'"><h2 class="'+this.classes.creationTitle+'">'+this.s.dt.i18n("stateRestore.removeTitle",this.c.i18n.removeTitle)+"</h2></div>"),scrollerToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.scrollerToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.scroller",this.c.i18n.creationModal.scroller)+"</div>"),searchBuilderToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.searchBuilderToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.searchBuilder",this.c.i18n.creationModal.searchBuilder)+"</div>"),searchPanesToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.searchPanesToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.searchPanes",this.c.i18n.creationModal.searchPanes)+"</div>"),searchToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.searchToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.search",this.c.i18n.creationModal.search)+"</div>"),selectToggle:$$1('<div class="'+this.classes.checkLabel+'"><input type="checkbox" class="'+this.classes.selectToggle+" "+this.classes.checkBox+'" checked>'+this.s.dt.i18n("stateRestore.creationModal.select",this.c.i18n.creationModal.select)+"</div>")},table.settings()[0]._stateRestore=this,this._searchForStates(),this._addPreDefined(this.c.preDefined);var ajaxData={action:"load"};return"function"==typeof this.c.ajax?ajaxFunction=function(){"function"==typeof _this.c.ajax&&_this.c.ajax.call(_this.s.dt,ajaxData,(function(s){return _this._addPreDefined(s)}))}:"string"==typeof this.c.ajax&&(ajaxFunction=function(){$$1.ajax({data:ajaxData,success:function(data){_this._addPreDefined(data)},type:"POST",url:_this.c.ajax})}),"function"==typeof ajaxFunction&&(this.s.dt.settings()[0]._bInitComplete?ajaxFunction():this.s.dt.one("preInit.dtsr",(function(){ajaxFunction()}))),this.s.dt.on("destroy.dtsr",(function(){_this.destroy()})),this.s.dt.on("draw.dtsr buttons-action.dtsr",(function(){return _this.findActive()})),this}}return StateRestoreCollection.prototype.addState=function(identifier,currentIdentifiers,options){var _this=this;if(this.c.create&&this.c.save){var createFunction=function(id,toggles){if(0===id.length)return"empty";if(currentIdentifiers.includes(id))return"duplicate";_this.s.dt.state.save();var that=_this,currState=_this.s.dt.state();if(currState.stateRestore={isPredefined:!1,state:id,tableId:_this.s.dt.table().node().id},toggles.saveState){for(var opts=_this.c.saveState,_i=0,_a=Object.keys(toggles.saveState);_i<_a.length;_i++){var key=_a[_i];if("object"==typeof toggles.saveState[key])for(var _b=0,_c=Object.keys(toggles.saveState[key]);_b<_c.length;_b++){var nestedKey=_c[_b];toggles.saveState[key][nestedKey]||(opts[key][nestedKey]=!1)}else toggles.saveState[key]||(opts[key]=!1)}_this.c.saveState=opts}var newState=new StateRestore(_this.s.dt.settings()[0],$$1.extend(!0,{},_this.c,options),id,currState,!1,(function(){that.s.states.push(this),that._collectionRebuild()}));return $$1(_this.s.dt.table().node()).on("dtsr-modal-inserted",(function(){newState.dom.confirmation.one("dtsr-remove",(function(){return _this._removeCallback(newState.s.identifier)})),newState.dom.confirmation.one("dtsr-rename",(function(){return _this._collectionRebuild()})),newState.dom.confirmation.one("dtsr-save",(function(){return _this._collectionRebuild()}))})),!0};if(null!==this.getState(identifier))throw new Error(this.s.dt.i18n("stateRestore.duplicateError",this.c.i18n.duplicateError));if(this.c.creationModal||void 0!==options&&options.creationModal)this._creationModal(createFunction,identifier,options);else{var success=createFunction(identifier,{});if("empty"===success)throw new Error(this.s.dt.i18n("stateRestore.emptyError",this.c.i18n.emptyError));if("duplicate"===success)throw new Error(this.s.dt.i18n("stateRestore.duplicateError",this.c.i18n.duplicateError))}}},StateRestoreCollection.prototype.removeAll=function(removeFunction){if(0!==this.s.states.length){var ids=this.s.states.map((function(state){return state.s.identifier})),replacementString=ids[0];ids.length>1&&(replacementString=ids.slice(0,-1).join(", ")+this.s.dt.i18n("stateRestore.removeJoiner",this.c.i18n.removeJoiner)+ids.slice(-1)),$$1(this.dom.removeContents.children("span")).html(this.s.dt.i18n("stateRestore.removeConfirm",this.c.i18n.removeConfirm).replace(/%s/g,replacementString)),this._newModal(this.dom.removeTitle,this.s.dt.i18n("stateRestore.removeSubmit",this.c.i18n.removeSubmit),removeFunction,this.dom.removeContents)}},StateRestoreCollection.prototype.destroy=function(){for(var _i=0,_a=this.s.states;_i<_a.length;_i++){_a[_i].destroy()}$$1.each(this.dom,(function(name,el){el.off().remove()})),this.s.states=[],this.s.dt.off(".dtsr"),$$1(this.s.dt.table().node()).off(".dtsr")},StateRestoreCollection.prototype.findActive=function(){this.s.dt.state.save();for(var button,currState=this.s.dt.state(),buttons=this.s.dt.buttons().nodes(),_i=0,buttons_1=buttons;_i<buttons_1.length;_i++)button=buttons_1[_i],($$1(button).hasClass("dtsr-state")||$$1(button).children().hasClass("dtsr-state"))&&this.s.dt.button(button).active(!1);for(var results=[],_a=0,_b=this.s.states;_a<_b.length;_a++){var state=_b[_a];if(state.compare(currState)){results.push({data:state.s.savedState,name:state.s.identifier});for(var _c=0,buttons_2=buttons;_c<buttons_2.length;_c++){button=buttons_2[_c];var btn=this.s.dt.button(button);if(btn.text()===state.s.identifier){btn.active(!0);break}}}}return results},StateRestoreCollection.prototype.getState=function(identifier){for(var _i=0,_a=this.s.states;_i<_a.length;_i++){var state=_a[_i];if(state.s.identifier===identifier)return state}return null},StateRestoreCollection.prototype.getStates=function(ids){if(void 0===ids)return this.s.states;for(var states=[],_i=0,ids_1=ids;_i<ids_1.length;_i++){for(var id=ids_1[_i],found=!1,_a=0,_b=this.s.states;_a<_b.length;_a++){var state=_b[_a];if(id===state.s.identifier){states.push(state),found=!0;break}}found||states.push(void 0)}return states},StateRestoreCollection.prototype._addPreDefined=function(preDefined){for(var _this=this,states=Object.keys(preDefined).sort((function(a,b){return a>b?1:a<b?-1:0})),_loop_1=function(state){for(var i=0;i<this_1.s.states.length;i++)this_1.s.states[i].s.identifier===state&&this_1.s.states.splice(i,1);var that=this_1,loadedState=preDefined[state],newState=new StateRestore(this_1.s.dt,$$1.extend(!0,{},this_1.c,void 0!==loadedState.c?{saveState:loadedState.c.saveState}:void 0,!0),state,loadedState,!0,(function(){that.s.states.push(this),that._collectionRebuild()}));newState.s.savedState=loadedState,$$1(this_1.s.dt.table().node()).on("dtsr-modal-inserted",(function(){newState.dom.confirmation.one("dtsr-remove",(function(){return _this._removeCallback(newState.s.identifier)})),newState.dom.confirmation.one("dtsr-rename",(function(){return _this._collectionRebuild()})),newState.dom.confirmation.one("dtsr-save",(function(){return _this._collectionRebuild()}))}))},this_1=this,_i=0,states_1=states;_i<states_1.length;_i++){_loop_1(states_1[_i])}},StateRestoreCollection.prototype._collectionRebuild=function(){var i,button=this.s.dt.button("SaveStateRestore:name"),stateButtons=[];if(button[0]){var idxs=button.index().split("-");for(stateButtons=button[0].inst.c.buttons,i=0;i<idxs.length;i++){if(!stateButtons[idxs[i]].buttons){stateButtons=[];break}stateButtons=stateButtons[idxs[i]].buttons}}for(i=0;i<stateButtons.length;i++)"stateRestore"===stateButtons[i].extend&&(stateButtons.splice(i,1),i--);this.c._createInSaved&&stateButtons.push("createState");var emptyText='<span class="'+this.classes.emptyStates+'">'+this.s.dt.i18n("stateRestore.emptyStates",this.c.i18n.emptyStates)+"</span>";if(0===this.s.states.length)stateButtons.includes(emptyText)||stateButtons.push(emptyText);else{for(;stateButtons.includes(emptyText);)stateButtons.splice(stateButtons.indexOf(emptyText),1);this.s.states=this.s.states.sort((function(a,b){var aId=a.s.identifier,bId=b.s.identifier;return aId>bId?1:aId<bId?-1:0}));for(var _i=0,_a=this.s.states;_i<_a.length;_i++){var state=_a[_i],split=this.c.splitSecondaries.slice();!split.includes("updateState")||this.c.save&&state.c.save||split.splice(split.indexOf("updateState"),1),!split.includes("renameState")||this.c.save&&state.c.save&&this.c.rename&&state.c.rename||split.splice(split.indexOf("renameState"),1),!split.includes("removeState")||this.c.remove&&state.c.remove||split.splice(split.indexOf("removeState"),1),stateButtons.push({_stateRestore:state,attr:{title:state.s.identifier},config:{split:split},extend:"stateRestore",text:StateRestore.entityEncode(state.s.identifier),popoverTitle:StateRestore.entityEncode(state.s.identifier)})}}button.collectionRebuild(stateButtons);for(var _b=0,buttons_3=this.s.dt.buttons();_b<buttons_3.length;_b++){var butt=buttons_3[_b];$$1(butt.node).hasClass("dtsr-removeAllStates")&&(0===this.s.states.length?this.s.dt.button(butt.node).disable():this.s.dt.button(butt.node).enable())}},StateRestoreCollection.prototype._creationModal=function(buttonAction,identifier,options){var _this=this;this.dom.creation.empty(),this.dom.creationForm.empty(),this.dom.nameInputRow.find("input").val(identifier),this.dom.creationForm.append(this.dom.nameInputRow);var toggle,tableConfig=this.s.dt.settings()[0].oInit,togglesToInsert=[],toggleDefined=void 0!==options&&void 0!==options.toggle;((!toggleDefined||void 0===options.toggle.order)&&this.c.toggle.order||toggleDefined&&options.toggle.order)&&this.c.saveState.order&&(void 0===tableConfig.ordering||tableConfig.ordering)&&togglesToInsert.push(this.dom.orderToggle),((!toggleDefined||void 0===options.toggle.search)&&this.c.toggle.search||toggleDefined&&options.toggle.search)&&this.c.saveState.search&&(void 0===tableConfig.searching||tableConfig.searching)&&togglesToInsert.push(this.dom.searchToggle),((!toggleDefined||void 0===options.toggle.paging)&&this.c.toggle.paging||toggleDefined&&options.toggle.paging)&&this.c.saveState.paging&&(void 0===tableConfig.paging||tableConfig.paging)&&togglesToInsert.push(this.dom.pagingToggle),((!toggleDefined||void 0===options.toggle.length)&&this.c.toggle.length||toggleDefined&&options.toggle.length)&&this.c.saveState.length&&(void 0===tableConfig.length||tableConfig.length)&&togglesToInsert.push(this.dom.lengthToggle),this.s.hasColReorder&&((!toggleDefined||void 0===options.toggle.colReorder)&&this.c.toggle.colReorder||toggleDefined&&options.toggle.colReorder)&&this.c.saveState.colReorder&&togglesToInsert.push(this.dom.colReorderToggle),this.s.hasScroller&&((!toggleDefined||void 0===options.toggle.scroller)&&this.c.toggle.scroller||toggleDefined&&options.toggle.scroller)&&this.c.saveState.scroller&&togglesToInsert.push(this.dom.scrollerToggle),this.s.hasSearchBuilder&&((!toggleDefined||void 0===options.toggle.searchBuilder)&&this.c.toggle.searchBuilder||toggleDefined&&options.toggle.searchBuilder)&&this.c.saveState.searchBuilder&&togglesToInsert.push(this.dom.searchBuilderToggle),this.s.hasSearchPanes&&((!toggleDefined||void 0===options.toggle.searchPanes)&&this.c.toggle.searchPanes||toggleDefined&&options.toggle.searchPanes)&&this.c.saveState.searchPanes&&togglesToInsert.push(this.dom.searchPanesToggle),this.s.hasSelect&&((!toggleDefined||void 0===options.toggle.select)&&this.c.toggle.select||toggleDefined&&options.toggle.select)&&this.c.saveState.select&&togglesToInsert.push(this.dom.selectToggle),"boolean"==typeof this.c.toggle.columns&&((!toggleDefined||void 0===options.toggle.order)&&this.c.toggle.columns||toggleDefined&&options.toggle.order)&&this.c.saveState.columns?(togglesToInsert.push(this.dom.columnsSearchToggle),togglesToInsert.push(this.dom.columnsVisibleToggle)):(toggleDefined&&void 0!==options.toggle.columns||"boolean"==typeof this.c.toggle.columns)&&"boolean"==typeof options.toggle.order||("boolean"!=typeof this.c.saveState.columns&&this.c.saveState.columns?((toggleDefined&&void 0!==options.toggle.columns&&"boolean"!=typeof options.toggle.columns&&options.toggle.columns.search||(!toggleDefined||void 0===options.toggle.columns||"boolean"!=typeof options.toggle.columns&&void 0===options.toggle.columns.search)&&"boolean"!=typeof this.c.toggle.columns&&this.c.toggle.columns.search)&&this.c.saveState.columns.search&&togglesToInsert.push(this.dom.columnsSearchToggle),(toggleDefined&&void 0!==options.toggle.columns&&"boolean"!=typeof options.toggle.columns&&options.toggle.columns.visible||(!toggleDefined||void 0===options.toggle.columns||"boolean"!=typeof options.toggle.columns&&void 0===options.toggle.columns.visible)&&"boolean"!=typeof this.c.toggle.columns&&this.c.toggle.columns.visible)&&this.c.saveState.columns.visible&&togglesToInsert.push(this.dom.columnsVisibleToggle)):this.c.saveState.columns&&(togglesToInsert.push(this.dom.columnsSearchToggle),togglesToInsert.push(this.dom.columnsVisibleToggle))),togglesToInsert.sort((function(a,b){var aVal=a.text(),bVal=b.text();return aVal<bVal?-1:aVal>bVal?1:0}));for(var checkboxesEl=this.dom.checkboxInputRow.appendTo(this.dom.creationForm).find("div.dtsr-input").empty(),_i=0,togglesToInsert_1=togglesToInsert;_i<togglesToInsert_1.length;_i++)toggle=togglesToInsert_1[_i],checkboxesEl.append(toggle);this.dom.background.appendTo(this.dom.dtContainer),this.dom.creation.append(this.dom.creationTitle).append(this.dom.creationForm).append(this.dom.createButtonRow).appendTo(this.dom.dtContainer),$$1(this.s.dt.table().node()).trigger("dtsr-modal-inserted");for(var _a=0,togglesToInsert_2=togglesToInsert;_a<togglesToInsert_2.length;_a++)toggle=togglesToInsert_2[_a],$$1(toggle.children("label:last-child")).on("click",(function(){toggle.children("input").prop("checked",!toggle.children("input").prop("checked"))}));var creationButton=$$1("button."+this.classes.creationButton.replace(/ /g,".")),inputs=this.dom.creationForm.find("input");inputs.length>0?$$1(inputs[0]).focus():creationButton.focus();var background=$$1("div."+this.classes.background.replace(/ /g,".")),keyupFunction=function(e){"Enter"===e.key?creationButton.click():"Escape"===e.key&&background.click()};this.c.modalCloseButton&&(this.dom.creation.append(this.dom.closeButton),this.dom.closeButton.on("click",(function(){return background.click()}))),creationButton.on("click",(function(){var saveState={colReorder:_this.dom.colReorderToggle.find("input").is(":checked"),columns:{search:_this.dom.columnsSearchToggle.find("input").is(":checked"),visible:_this.dom.columnsVisibleToggle.find("input").is(":checked")},length:_this.dom.lengthToggle.find("input").is(":checked"),order:_this.dom.orderToggle.find("input").is(":checked"),paging:_this.dom.pagingToggle.find("input").is(":checked"),scroller:_this.dom.scrollerToggle.find("input").is(":checked"),search:_this.dom.searchToggle.find("input").is(":checked"),searchBuilder:_this.dom.searchBuilderToggle.find("input").is(":checked"),searchPanes:_this.dom.searchPanesToggle.find("input").is(":checked"),select:_this.dom.selectToggle.find("input").is(":checked")},success=buttonAction($$1("input."+_this.classes.nameInput.replace(/ /g,".")).val(),{saveState:saveState});!0===success?(_this.dom.background.remove(),_this.dom.creation.remove(),$$1(document).unbind("keyup",keyupFunction)):(_this.dom.creation.children("."+_this.classes.modalError).remove(),_this.dom.creation.append(_this.dom[success+"Error"]))})),background.one("click",(function(){_this.dom.background.remove(),_this.dom.creation.remove(),$$1(document).unbind("keyup",keyupFunction),_this._collectionRebuild()})),$$1(document).on("keyup",keyupFunction),this.s.dt.state.save()},StateRestoreCollection.prototype._removeCallback=function(identifier){for(var i=0;i<this.s.states.length;i++)this.s.states[i].s.identifier===identifier&&(this.s.states.splice(i,1),i--);return this._collectionRebuild(),!0},StateRestoreCollection.prototype._newModal=function(title,buttonText,buttonAction,modalContents){var _this=this;this.dom.background.appendTo(this.dom.dtContainer),this.dom.confirmationTitleRow.empty().append(title);var confirmationButton=$$1('<button class="'+this.classes.confirmationButton+" "+this.classes.dtButton+'">'+buttonText+"</button>");this.dom.confirmation.empty().append(this.dom.confirmationTitleRow).append(modalContents).append($$1('<div class="'+this.classes.confirmationButtons+'"></div>').append(confirmationButton)).appendTo(this.dom.dtContainer),$$1(this.s.dt.table().node()).trigger("dtsr-modal-inserted");var inputs=modalContents.children("input");inputs.length>0?$$1(inputs[0]).focus():confirmationButton.focus();var background=$$1("div."+this.classes.background.replace(/ /g,".")),keyupFunction=function(e){"Enter"===e.key?confirmationButton.click():"Escape"===e.key&&background.click()};confirmationButton.on("click",(function(){var success=buttonAction(!0);!0===success?(_this.dom.background.remove(),_this.dom.confirmation.remove(),$$1(document).unbind("keyup",keyupFunction),confirmationButton.off("click")):(_this.dom.confirmation.children("."+_this.classes.modalError).remove(),_this.dom.confirmation.append(_this.dom[success+"Error"]))})),this.dom.confirmation.on("click",(function(e){e.stopPropagation()})),background.one("click",(function(){_this.dom.background.remove(),_this.dom.confirmation.remove(),$$1(document).unbind("keyup",keyupFunction)})),$$1(document).on("keyup",keyupFunction)},StateRestoreCollection.prototype._searchForStates=function(){for(var _this=this,keys=Object.keys(localStorage),_loop_2=function(key){if(key.match(new RegExp("^DataTables_stateRestore_.*_"+location.pathname+"$"))||key.match(new RegExp("^DataTables_stateRestore_.*_"+location.pathname+"_"+this_2.s.dt.table().node().id+"$"))){var loadedState_1=JSON.parse(localStorage.getItem(key));if(loadedState_1.stateRestore.isPreDefined||loadedState_1.stateRestore.tableId&&loadedState_1.stateRestore.tableId!==this_2.s.dt.table().node().id)return"continue";var that_1=this_2,newState_1=new StateRestore(this_2.s.dt,$$1.extend(!0,{},this_2.c,{saveState:loadedState_1.c.saveState}),loadedState_1.stateRestore.state,loadedState_1,!1,(function(){this.s.savedState=loadedState_1,that_1.s.states.push(this),that_1._collectionRebuild()}));$$1(this_2.s.dt.table().node()).on("dtsr-modal-inserted",(function(){newState_1.dom.confirmation.one("dtsr-remove",(function(){return _this._removeCallback(newState_1.s.identifier)})),newState_1.dom.confirmation.one("dtsr-rename",(function(){return _this._collectionRebuild()})),newState_1.dom.confirmation.one("dtsr-save",(function(){return _this._collectionRebuild()}))}))}},this_2=this,_i=0,keys_1=keys;_i<keys_1.length;_i++){_loop_2(keys_1[_i])}},StateRestoreCollection.version="1.0.0",StateRestoreCollection.classes={background:"dtsr-background",checkBox:"dtsr-check-box",checkLabel:"dtsr-check-label",checkRow:"dtsr-check-row",closeButton:"dtsr-popover-close",colReorderToggle:"dtsr-colReorder-toggle",columnsSearchToggle:"dtsr-columns-search-toggle",columnsVisibleToggle:"dtsr-columns-visible-toggle",confirmation:"dtsr-confirmation",confirmationButton:"dtsr-confirmation-button",confirmationButtons:"dtsr-confirmation-buttons",confirmationMessage:"dtsr-confirmation-message dtsr-name-label",confirmationText:"dtsr-confirmation-text",confirmationTitle:"dtsr-confirmation-title",confirmationTitleRow:"dtsr-confirmation-title-row",creation:"dtsr-creation",creationButton:"dtsr-creation-button",creationForm:"dtsr-creation-form",creationText:"dtsr-creation-text",creationTitle:"dtsr-creation-title",dtButton:"dt-button",emptyStates:"dtsr-emptyStates",formRow:"dtsr-form-row",leftSide:"dtsr-left",lengthToggle:"dtsr-length-toggle",modalError:"dtsr-modal-error",modalFoot:"dtsr-modal-foot",nameInput:"dtsr-name-input",nameLabel:"dtsr-name-label",orderToggle:"dtsr-order-toggle",pagingToggle:"dtsr-paging-toggle",rightSide:"dtsr-right",scrollerToggle:"dtsr-scroller-toggle",searchBuilderToggle:"dtsr-searchBuilder-toggle",searchPanesToggle:"dtsr-searchPanes-toggle",searchToggle:"dtsr-search-toggle",selectToggle:"dtsr-select-toggle",toggleLabel:"dtsr-toggle-title"},StateRestoreCollection.defaults={_createInSaved:!1,ajax:!1,create:!0,creationModal:!1,i18n:{creationModal:{button:"Create",colReorder:"Column Order",columns:{search:"Column Search",visible:"Column Visibility"},length:"Page Length",name:"Name:",order:"Sorting",paging:"Paging",scroller:"Scroll Position",search:"Search",searchBuilder:"SearchBuilder",searchPanes:"SearchPanes",select:"Select",title:"Create New State",toggleLabel:"Include:"},duplicateError:"A state with this name already exists.",emptyError:"Name cannot be empty.",emptyStates:"No saved states",removeConfirm:"Are you sure you want to remove %s?",removeError:"Failed to remove state.",removeJoiner:" and ",removeSubmit:"Remove",removeTitle:"Remove State",renameButton:"Rename",renameLabel:"New Name for %s:",renameTitle:"Rename State"},modalCloseButton:!0,preDefined:{},remove:!0,rename:!0,save:!0,saveState:{colReorder:!0,columns:{search:!0,visible:!0},length:!0,order:!0,paging:!0,scroller:!0,search:!0,searchBuilder:!0,searchPanes:!0,select:!0},splitSecondaries:["updateState","renameState","removeState"],toggle:{colReorder:!1,columns:{search:!1,visible:!1},length:!1,order:!1,paging:!1,scroller:!1,search:!1,searchBuilder:!1,searchPanes:!1,select:!1}},StateRestoreCollection}();$$2=jq=$,dataTable$1=jq.fn.dataTable,function(jq){$$1=jq,dataTable=jq.fn.dataTable}($),$.fn.dataTable.StateRestore=StateRestore,$.fn.DataTable.StateRestore=StateRestore,$.fn.dataTable.StateRestoreCollection=StateRestoreCollection,$.fn.DataTable.StateRestoreCollection=StateRestoreCollection;var apiRegister=DataTable.Api.register;function _buttonInit(dt,config){_stateRegen(dt,new DataTable.StateRestoreCollection(dt,config.config))}function _stateRegen(dt,src){var i,states=dt.stateRestore.states(),button=dt.button("SaveStateRestore:name"),stateButtons=[];if(button[0]){var idxs=button.index().split("-");for(stateButtons=button[0].inst.c.buttons,i=0;i<idxs.length;i++){if(!stateButtons[idxs[i]].buttons){stateButtons=[];break}stateButtons=stateButtons[idxs[i]].buttons}}var stateRestoreOpts=dt.settings()[0]._stateRestore.c;for(i=0;i<stateButtons.length;i++)"stateRestore"===stateButtons[i].extend&&(stateButtons.splice(i,1),i--);if(stateRestoreOpts._createInSaved&&stateButtons.push("createState"),void 0===states||0===states.length)stateButtons.push('<span class="'+src.classes.emptyStates+'">'+dt.i18n("stateRestore.emptyStates",src.c.i18n.emptyStates)+"</span>");else for(var _i=0,states_5=states;_i<states_5.length;_i++){var state=states_5[_i],split=stateRestoreOpts.splitSecondaries.slice();split.includes("updateState")&&!stateRestoreOpts.save&&split.splice(split.indexOf("updateState"),1),!split.includes("renameState")||stateRestoreOpts.save&&stateRestoreOpts.rename||split.splice(split.indexOf("renameState"),1),split.includes("removeState")&&!stateRestoreOpts.remove&&split.splice(split.indexOf("removeState"),1),stateButtons.push({_stateRestore:state,attr:{title:state.s.identifier},config:{split:split},extend:"stateRestore",text:StateRestore.entityEncode(state.s.identifier),popoverTitle:StateRestore.entityEncode(state.s.identifier)})}dt.button("SaveStateRestore:name").collectionRebuild(stateButtons);for(var _a=0,buttons_2=dt.buttons();_a<buttons_2.length;_a++){var butt=buttons_2[_a];$(butt.node).hasClass("dtsr-removeAllStates")&&(0===states.length?dt.button(butt.node).disable():dt.button(butt.node).enable())}}apiRegister("stateRestore()",(function(){return this})),apiRegister("stateRestore.state()",(function(identifier){var ctx=this.context[0];if(!ctx._stateRestore){var api=DataTable.Api(ctx);_stateRegen(api,new DataTable.StateRestoreCollection(api,{}))}return this[0]=ctx._stateRestore.getState(identifier),this})),apiRegister("stateRestore.state.add()",(function(identifier,options){var ctx=this.context[0];if(!ctx._stateRestore){var api=DataTable.Api(ctx);_stateRegen(api,new DataTable.StateRestoreCollection(api,{}))}if(!ctx._stateRestore.c.create)return this;if(ctx._stateRestore.addState){for(var ids=[],_i=0,states_1=ctx._stateRestore.s.states;_i<states_1.length;_i++){var intState=states_1[_i];ids.push(intState.s.identifier)}return ctx._stateRestore.addState(identifier,ids,options),this}})),apiRegister("stateRestore.states()",(function(ids){var ctx=this.context[0];if(!ctx._stateRestore){var api=DataTable.Api(ctx);_stateRegen(api,new DataTable.StateRestoreCollection(api,{}))}return this.length=0,this.push.apply(this,ctx._stateRestore.getStates(ids)),this})),apiRegister("stateRestore.state().save()",(function(){var ctx=this[0];return ctx.c.save&&ctx.save(),this})),apiRegister("stateRestore.state().rename()",(function(newIdentifier){var ctx=this.context[0],state=this[0];if(state.c.save){for(var ids=[],_i=0,states_2=ctx._stateRestore.s.states;_i<states_2.length;_i++){var intState=states_2[_i];ids.push(intState.s.identifier)}state.rename(newIdentifier,ids)}return this})),apiRegister("stateRestore.state().load()",(function(){return this[0].load(),this})),apiRegister("stateRestore.state().remove()",(function(skipModal){var ctx=this[0];return ctx.c.remove&&ctx.remove(skipModal),this})),apiRegister("stateRestore.states().remove()",(function(skipModal){var _this=this,removeAllCallBack=function(skipModalIn){for(var success=!0,that=_this.toArray();that.length>0;){var set=that[0];if(void 0===set||!set.c.remove)break;var tempSuccess=set.remove(skipModalIn);!0!==tempSuccess?success=tempSuccess:that.splice(0,1)}return success};return this.context[0]._stateRestore&&this.context[0]._stateRestore.c.remove&&(skipModal?removeAllCallBack(skipModal):this.context[0]._stateRestore.removeAll(removeAllCallBack)),this})),apiRegister("stateRestore.activeStates()",(function(){var ctx=this.context[0];if(this.length=0,!ctx._stateRestore){var api=DataTable.Api(ctx);_stateRegen(api,new DataTable.StateRestoreCollection(api,{}))}return ctx._stateRestore&&this.push.apply(this,ctx._stateRestore.findActive()),this})),DataTable.ext.buttons.stateRestore={action:function(e,dt,node,config){config._stateRestore.load(),node.blur()},className:"dtsr-state",config:{split:["updateState","renameState","removeState"]},text:function(dt){return dt.i18n("buttons.stateRestore","State %d",dt.stateRestore.states()[0].length+1)}},DataTable.ext.buttons.updateState={action:function(e,dt,node,config){$("div.dt-button-background").click(),config.parent._stateRestore.save()},text:function(dt){return dt.i18n("buttons.updateState","Update")}},DataTable.ext.buttons.savedStates={buttons:[],extend:"collection",init:function(dt,node,config){dt.on("stateRestore-change",(function(){dt.button(node).text(dt.i18n("buttons.savedStates","Saved States",dt.stateRestore.states().length))})),void 0===dt.settings()[0]._stateRestore&&_buttonInit(dt,config)},name:"SaveStateRestore",text:function(dt){return dt.i18n("buttons.savedStates","Saved States",0)}},DataTable.ext.buttons.savedStatesCreate={buttons:[],extend:"collection",init:function(dt,node,config){dt.on("stateRestore-change",(function(){dt.button(node).text(dt.i18n("buttons.savedStates","Saved States",dt.stateRestore.states().length))})),void 0===dt.settings()[0]._stateRestore&&(void 0===config.config&&(config.config={}),config.config._createInSaved=!0,_buttonInit(dt,config))},name:"SaveStateRestore",text:function(dt){return dt.i18n("buttons.savedStates","Saved States",0)}},DataTable.ext.buttons.createState={action:function(e,dt,node,config){e.stopPropagation();var stateRestoreOpts=dt.settings()[0]._stateRestore.c,language=dt.settings()[0].oLanguage;if(stateRestoreOpts.create&&stateRestoreOpts.save){var replaceRegex,prevStates=dt.stateRestore.states().toArray(),defaultString=void 0!==language.buttons&&void 0!==language.buttons.stateRestore?language.buttons.stateRestore:"State ";if(defaultString.indexOf("%d")===defaultString.length-3)replaceRegex=new RegExp(defaultString.replace(/%d/g,""));else{var splitString=defaultString.split("%d");replaceRegex=[];for(var _i=0,splitString_1=splitString;_i<splitString_1.length;_i++){var parts=splitString_1[_i];replaceRegex.push(new RegExp(parts))}}var getId=function(identifier){var id;if(Array.isArray(replaceRegex)){id=identifier;for(var _i=0,replaceRegex_1=replaceRegex;_i<replaceRegex_1.length;_i++){var reg=replaceRegex_1[_i];id=id.replace(reg,"")}}else id=identifier.replace(replaceRegex,"");return isNaN(+id)||id.length===identifier?0:+id},identifiers=prevStates.map((function(state){return getId(state.s.identifier)})).sort((function(a,b){return+a<+b?1:+a>+b?-1:0})),lastNumber=identifiers[0];dt.stateRestore.state.add(dt.i18n("buttons.stateRestore","State %d",void 0!==lastNumber?lastNumber+1:1),config.config);for(var states=dt.stateRestore.states().sort((function(a,b){var aId=+getId(a.s.identifier),bId=+getId(b.s.identifier);return aId>bId?1:aId<bId?-1:0})),button=dt.button("SaveStateRestore:name"),stateButtons=void 0!==button[0]&&void 0!==button[0].inst.c.buttons[0].buttons?button[0].inst.c.buttons[0].buttons:[],i=0;i<stateButtons.length;i++)"stateRestore"===stateButtons[i].extend&&(stateButtons.splice(i,1),i--);stateRestoreOpts._createInSaved&&stateButtons.push("createState");for(var _a=0,states_3=states;_a<states_3.length;_a++){var state=states_3[_a],split=stateRestoreOpts.splitSecondaries.slice();split.includes("updateState")&&!stateRestoreOpts.save&&split.splice(split.indexOf("updateState"),1),!split.includes("renameState")||stateRestoreOpts.save&&stateRestoreOpts.rename||split.splice(split.indexOf("renameState"),1),split.includes("removeState")&&!stateRestoreOpts.remove&&split.splice(split.indexOf("removeState"),1),stateButtons.push({_stateRestore:state,attr:{title:state.s.identifier},config:{split:split},extend:"stateRestore",text:StateRestore.entityEncode(state.s.identifier),popoverTitle:StateRestore.entityEncode(state.s.identifier)})}dt.button("SaveStateRestore:name").collectionRebuild(stateButtons),node.blur();for(var _b=0,buttons_1=dt.buttons();_b<buttons_1.length;_b++){var butt=buttons_1[_b];$(butt.node).hasClass("dtsr-removeAllStates")&&(0===states.length?dt.button(butt.node).disable():dt.button(butt.node).enable())}}},init:function(dt,node,config){void 0===dt.settings()[0]._stateRestore&&dt.button("SaveStateRestore:name").length>1&&_buttonInit(dt,config)},text:function(dt){return dt.i18n("buttons.createState","Create State")}},DataTable.ext.buttons.removeState={action:function(e,dt,node,config){config.parent._stateRestore.remove(),node.blur()},text:function(dt){return dt.i18n("buttons.removeState","Remove")}},DataTable.ext.buttons.removeAllStates={action:function(e,dt,node){dt.stateRestore.states().remove(!0),node.blur()},className:"dt-button dtsr-removeAllStates",init:function(dt,node){dt.settings()[0]._stateRestore&&0!==dt.stateRestore.states().length||$(node).addClass("disabled")},text:function(dt){return dt.i18n("buttons.removeAllStates","Remove All States")}},DataTable.ext.buttons.renameState={action:function(e,dt,node,config){for(var ids=[],_i=0,states_4=dt.settings()[0]._stateRestore.s.states;_i<states_4.length;_i++){var state=states_4[_i];ids.push(state.s.identifier)}config.parent._stateRestore.rename(void 0,ids),node.blur()},text:function(dt){return dt.i18n("buttons.renameState","Rename")}},$(document).on("preInit.dt.dtsr",(function(e,settings){"dt"===e.namespace&&(settings.oInit.stateRestore||DataTable.defaults.stateRestore)&&(settings._stateRestore||function(settings,options){void 0===options&&(options=null);var api=new DataTable.Api(settings),opts=options||api.init().stateRestore||DataTable.defaults.stateRestore,stateRestore=new StateRestoreCollection(api,opts);_stateRegen(api,stateRestore)}(settings,null))}))}(),DataTable}));

//# sourceMappingURL=dataTables.stateRestore.min.js.map