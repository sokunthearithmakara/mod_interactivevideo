{"version":3,"file":"viewannotation.min.js","sources":["../src/viewannotation.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * View page module\n *\n * @module     mod_interactivevideo/viewannotation\n * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n    'jquery', 'core/event_dispatcher', 'core/toast', 'mod_interactivevideo/libraries/jquery-ui'\n], function ($, { dispatchEvent }, Toast) {\n    let ctRenderer = {};\n    let annotations, // Array of annotations.\n        totaltime, // Video total time.\n        activityType, // Current activityType.\n        lastanno, // Last run annotation.\n        contentTypes, // Array of available content types.\n        displayoptions, // Display options.\n        releventAnnotations, // Array of annotations that are not skipped.\n        player;\n\n    const $videoNav = $('#video-nav');\n\n    const convertSecondsToMinutes = (seconds) => {\n        if (seconds < 60) {\n            return seconds + 's';\n        } else {\n            const minutes = Math.floor(seconds / 60);\n            const remainingSeconds = seconds % 60;\n            return minutes + 'm ' + remainingSeconds + 's';\n        }\n    };\n\n    const renderAnnotationItems = async (annos, start, totaltime) => {\n        releventAnnotations = annos;\n\n        let actualduration = totaltime;\n\n        const skipsegments = annos.filter(x => x.type == 'skipsegment');\n\n        if (skipsegments.length > 0) {\n            skipsegments.forEach(x => {\n                const length = (Number(x.title) - Number(x.timestamp));\n                actualduration -= length;\n            });\n        }\n\n        const completableAnno = releventAnnotations.filter(x => JSON.parse(x.prop).hascompletion);\n        const actualAnnotationCounts = completableAnno.length;\n\n        const xp = completableAnno.map(x => Number(x.xp)).reduce((a, b) => a + b, 0);\n\n        const completedAnnos = completableAnno\n            .filter(x => x.completed);\n\n        const xpEarned = completedAnnos.map(x => Number(x.xp)).reduce((a, b) => a + b, 0);\n\n        $(\".metadata\").empty();\n        $(\".metadata\").append(`<span class=\"d-inline-block mr-3\">\n            <i class=\"bi bi-stopwatch mr-2\"></i>${convertSecondsToMinutes(Math.ceil(actualduration))}</span>\n            <span class=\"d-inline-block mr-3\">\n        <i class=\"bi bi-bullseye mr-2\"></i>${completedAnnos.length} / ${actualAnnotationCounts}</span>\n        <span class=\"d-inline-block\"><i class=\"bi bi-star mr-2\"></i>${xpEarned} / ${xp}</span>`);\n\n        $(\"#video-nav ul\").empty();\n\n        if (annos.length == 0) {\n            return;\n        }\n\n        if (displayoptions.preventseeking == 1) {\n            $videoNav.addClass('no-pointer-events');\n        }\n\n        if (displayoptions.hidemainvideocontrols == 1 || displayoptions.hideinteractions == 1) {\n            if (displayoptions.hidemainvideocontrols == 1) {\n                $('#wrapper').addClass('no-videonav');\n            }\n            return;\n        }\n        const render = new Promise((resolve) => {\n            annos.forEach(async (x) => {\n                const renderer = ctRenderer[x.type];\n                renderer.renderItemOnVideoNavigation(x);\n            });\n            resolve();\n        });\n\n        render.then(() => {\n            dispatchEvent('annotationitemsrendered', { 'annotations': annos });\n            $('.annolistinchapter').empty();\n            const chapteritems = releventAnnotations.filter(x => x.type != 'skipsegment' && JSON.parse(x.prop).hascompletion);\n            chapteritems.sort((a, b) => a.timestamp - b.timestamp);\n            chapteritems.forEach((x) => {\n                $('[data-region=\"chapterlists\"] li').each(function () {\n                    const cstart = $(this).data('start');\n                    const cend = $(this).data('end');\n                    if (x.timestamp >= cstart && x.timestamp < cend) {\n                        $(this).find('.annolistinchapter')\n                            .append(`<li class=\"border-bottom anno d-flex align-items-center justify-content-between\n                         px-3 py-2 ${x.completed ? \"completed\" : \"\"}\" data-id=\"${x.id}\" data-timestamp=\"${x.timestamp}\">\n                         <span class=\"text-nowrap\">\n                         <i class=\"small bi ${x.completed ? \"bi-check-circle-fill text-success\" : 'bi-circle'} mr-2\"></i>\n                         <i class=\"${JSON.parse(x.prop).icon} mr-2\"></i></span>\n                         <span class=\"flex-grow-1 text-truncate\">${x.formattedtitle}</span>\n                         <span class=\"text-nowrap\">${x.xp}<i class=\"bi bi-star ml-1\"></i></span></li>`);\n                    }\n                });\n            });\n        }).then(() => {\n            dispatchEvent('chapterrendered', { 'annotations': releventAnnotations });\n        });\n\n        $(document).on('annotationitemsrendered', function () {\n            $('#controler [data-toggle=\"tooltip\"]').tooltip({\n                container: '#controler',\n                boundary: 'window',\n            });\n            if (displayoptions.disableinteractionclickuntilcompleted == 1) {\n                $videoNav.find('ul li:not(.completed):not(.chapter)').addClass('no-click');\n            }\n            if (displayoptions.disableinteractionclick == 1) {\n                $videoNav.find('ul li:not(.chapter)').addClass('no-click');\n            }\n            if (displayoptions.preventseeking == 1) {\n                $videoNav.find('ul li').addClass('no-click');\n                $videoNav.addClass('no-click');\n            }\n        });\n    };\n\n    return {\n        renderAnnotationItems: renderAnnotationItems,\n        init: function (\n            url, cmid, interaction, course, userid, start = 0, end,\n            completionpercentage, gradeiteminstance, grademax, vtype,\n            preventskip = true, moment = null, doptions = {}, token = null) {\n            // Convert start to number if string\n            start = Number(start);\n            if (isNaN(start)) {\n                start = 0;\n            }\n\n            // Convert end to number if string\n            end = Number(end);\n            if (isNaN(end)) {\n                end = null;\n            }\n\n            displayoptions = doptions;\n\n            let playerReady = false;\n\n            const convertSecondsToHMS = (seconds) => {\n                const h = Math.floor(seconds / 3600);\n                const m = Math.floor(seconds % 3600 / 60);\n                const s = Math.floor(seconds % 3600 % 60);\n                return (h > 0 ? h + ':' : '') + (m < 10 ? '0' : '') + m + ':' + (s < 10 ? '0' : '') + s;\n            };\n\n            const replaceProgressBars = (percentage) => {\n                percentage = percentage > 100 ? 100 : percentage;\n                $videoNav.find('#progress').replaceWith(`<div id=\"progress\" style=\"width: ${percentage}%;\"></div>`);\n                $videoNav.find('#seekhead').css('left', percentage + '%');\n            };\n\n            const getAnnotations = (callback) => {\n                // Get all interaction items.\n                const annnoitems = $.ajax({\n                    url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n                    method: \"POST\",\n                    dataType: \"text\",\n                    data: {\n                        action: 'get_items',\n                        sesskey: M.cfg.sesskey,\n                        id: interaction,\n                        contextid: M.cfg.courseContextId,\n                        token: token,\n                        cmid: cmid\n                    }\n                });\n\n                // Get current user progress.\n                const userprogress = $.ajax({\n                    url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n                    method: \"POST\",\n                    dataType: \"text\",\n                    data: {\n                        action: 'get_progress',\n                        sesskey: M.cfg.sesskey,\n                        id: interaction,\n                        uid: userid,\n                        token: token,\n                        cmid: cmid\n                    }\n                });\n\n                // Get all content types.\n                const getContentTypes = $.ajax({\n                    url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n                    method: \"POST\",\n                    dataType: \"text\",\n                    data: {\n                        action: 'getallcontenttypes',\n                        sesskey: M.cfg.sesskey,\n                        token: token,\n                        cmid: cmid\n                    }\n                });\n\n                $.when(annnoitems, userprogress, getContentTypes).done(function (annos, progress, ct) {\n                    annotations = JSON.parse(annos[0]);\n                    progress = JSON.parse(progress[0]);\n                    contentTypes = JSON.parse(ct[0]);\n                    // Get only annotations within the start and end times.\n                    // Remove the skip segments that are completely outside the start and end times.\n                    // Remove the annotations whose content type is not in the contentTypes.\n                    annotations = annotations.filter(x => {\n                        const inContentType = contentTypes.some(y => y.name === x.type);\n                        if (!inContentType) {\n                            return false;\n                        }\n\n                        if (x.type === 'skipsegment') {\n                            return !(x.timestamp > end || x.title < start);\n                        }\n\n                        return x.timestamp >= start && x.timestamp <= end;\n                    });\n\n                    const completedItems = progress.completeditems == '' ? [] : JSON.parse(progress.completeditems);\n                    annotations = annotations.map(x => {\n                        // First, let's make sure numbers are treated as numbers.\n                        x.timestamp = Number(x.timestamp);\n                        x.xp = Number(x.xp);\n                        if (x.type == 'skipsegment') {\n                            x.title = Number(x.title);\n                        }\n                        // Properties must be stringified so it can be passed through Fragment.\n                        x.prop = JSON.stringify(contentTypes.find(y => y.name == x.type));\n\n                        x.completed = completedItems.indexOf(x.id) > -1;\n\n                        // Handle the skip segments that are half inside the start and end times.\n                        if (x.type == 'skipsegment') {\n                            if (x.timestamp < start && x.title > start) {\n                                x.timestamp = start;\n                            }\n                            if (x.title > end && x.timestamp < end) {\n                                x.title = end;\n                            }\n                        }\n\n                        const advanced = JSON.parse(x.advanced);\n                        x.rerunnable = advanced && advanced.replaybehavior === '1';\n\n                        return x;\n                    });\n\n                    // Sort by timestamp.\n                    annotations.sort((a, b) => a.timestamp - b.timestamp);\n\n                    const skipsegments = annotations.filter(x => x.type == 'skipsegment');\n\n                    releventAnnotations = [];\n                    annotations.forEach(x => {\n                        let shouldAdd = true;\n                        skipsegments.forEach(y => {\n                            if (Number(x.timestamp) > Number(y.timestamp) && Number(x.timestamp) < Number(y.title)) {\n                                shouldAdd = false;\n                            }\n                        });\n                        if (shouldAdd) {\n                            releventAnnotations.push(x);\n                        }\n                    });\n\n                    if (releventAnnotations.length > 0 && !releventAnnotations.find(x => x.type == 'chapter')) {\n                        // Add a dummy chapter at the start of the video.\n                        releventAnnotations.unshift({\n                            id: 0,\n                            title: M.util.get_string('startchapter', 'mod_interactivevideo'),\n                            formattedtitle: M.util.get_string('startchapter', 'mod_interactivevideo'),\n                            timestamp: start,\n                            type: 'chapter',\n                            prop: JSON.stringify(contentTypes.find(x => x.name == 'chapter')),\n                            xp: 0,\n                            completed: true,\n                            hide: true\n                        });\n                    }\n\n                    const getRenderers = new Promise((resolve) => {\n                        const chapterContentType = contentTypes.find(x => x.name == 'chapter');\n                        // We want to use only the content types that are being used in the annotations\n                        contentTypes = contentTypes.filter(x => releventAnnotations.map(y => y.type).includes(x.name));\n                        if (contentTypes.length == 0) {\n                            // Remove the chapter toggle\n                            $('#chaptertoggle, #chapter-container-left, #chapter-container-right').remove();\n                            resolve(ctRenderer);\n                        } else {\n                            $('#chaptertoggle, #chapter-container-left, #chapter-container-right').removeClass('d-none');\n                        }\n                        if (!contentTypes.find(x => x.name == 'chapter')) {\n                            // Include the chapterContentType\n                            contentTypes.push(chapterContentType);\n                        }\n                        var count = 0;\n                        contentTypes.forEach(x => {\n                            require([x.amdmodule], function (Type) {\n                                ctRenderer[x.name] = new Type(player, releventAnnotations, interaction, course, userid,\n                                    completionpercentage, gradeiteminstance, grademax, vtype, preventskip, totaltime, start,\n                                    end, x, cmid, token);\n                                try {\n                                    ctRenderer[x.name].init();\n                                } catch (error) {\n                                    // Do nothing.\n                                }\n                                count++;\n                                if (count == contentTypes.length) {\n                                    resolve(ctRenderer);\n                                }\n                            });\n                        });\n                    });\n\n                    getRenderers.then(() => {\n                        renderAnnotationItems(releventAnnotations, start, totaltime);\n                        $(\"#play\").removeClass('d-none');\n                        $(\"#spinner\").remove();\n                        $(\"#video-info\").toggleClass('d-none d-flex');\n                        callback();\n                    });\n                });\n            };\n\n            const runInteraction = async (annotation) => {\n                // player.pause();\n                lastanno = annotation;\n                // Remove the previous message but keep the one below the video.\n                $('#annotation-modal').modal('hide');\n                $('#message').not('[data-placement=bottom]').not('.sticky').remove();\n                $('#end-screen, #start-screen').fadeOut(300);\n\n                if (preventskip) {\n                    const theAnnotations = releventAnnotations\n                        .filter(x => Number(x.timestamp) < Number(annotation.timestamp)\n                            && x.completed == false && JSON.parse(x.prop).hascompletion == true);\n                    if (theAnnotations.length > 0) {\n                        const theAnnotation = theAnnotations[0];\n                        player.pause();\n                        await player.seek((theAnnotation.timestamp - 0.7 > start) ? (theAnnotation.timestamp - 0.7) : start);\n                        Toast.add(M.util.get_string('youmustcompletethepreviousactivity', 'mod_interactivevideo'), {\n                            type: 'danger'\n                        });\n                        return;\n                    }\n                }\n                activityType = ctRenderer[annotation.type];\n                activityType.runInteraction(annotation);\n            };\n\n            const shareMoment = async () => {\n                if (!moment) {\n                    return;\n                }\n                // Check if the url has a timestamp using url params.\n                const urlParams = new URLSearchParams(window.location.search);\n                const time = Number(moment);\n                if (time && !isNaN(time) && time >= start && time <= end) {\n                    // Hide the start screen.\n                    $('#video-wrapper #start-screen').hide(0);\n                    await player.seek(time);\n                    player.play();\n                    const theAnnotation = releventAnnotations.find(x => x.timestamp == time);\n                    if (theAnnotation) {\n                        runInteraction(theAnnotation);\n                    }\n\n                    replaceProgressBars(((time - start) / totaltime) * 100);\n\n                }\n                urlParams.delete('t');\n                const newurl = window.location.protocol\n                    + '//' + window.location.host + window.location.pathname + '?' + urlParams.toString();\n                window.history.replaceState(null, null, newurl);\n            };\n\n            const onReady = () => {\n                if (player.support.playbackrate == false) {\n                    $('#changerate').remove();\n                }\n\n                if (player.support.quality == false) {\n                    $('#changequality').remove();\n                }\n\n                if (player.posterImage) {\n                    $('#video-wrapper #start-screen').css({\n                        'background': `url(${player.posterImage}) no-repeat center center / cover`,\n                    });\n                }\n                $(\".video-block\").css('background', 'transparent');\n                player.getDuration().then((duration) => {\n                    end = !end ? duration : Math.min(end, duration);\n                    start = start > end ? 0 : start;\n                    totaltime = end - start;\n                    getAnnotations(shareMoment);\n                    $('#duration').text(convertSecondsToHMS(totaltime));\n                });\n\n                // Recalculate the ratio of the video\n                player.ratio().then((ratio) => {\n                    $(\"#video-wrapper\").css('padding-bottom', (1 / ratio) * 100 + '%');\n                });\n\n                playerReady = true;\n                $('#start-screen #start').focus();\n\n                $('#seekhead').draggable({\n                    'containment': '#video-nav',\n                    'axis': 'x',\n                    'cursor': 'col-resize',\n                    'start': function () {\n                        $(this).addClass('active');\n                        $('#taskinfo').addClass('no-pointer-events');\n                        $(\"#message, #end-screen\").remove();\n                    },\n                    'drag': async function (event, ui) {\n                        let timestamp = ((ui.position.left) / $('#video-nav').width()) * totaltime + start;\n                        await player.seek(timestamp);\n                        player.pause();\n                    },\n                    'stop': async function (event, ui) {\n                        setTimeout(function () {\n                            $('#taskinfo').removeClass('no-pointer-events');\n                        }, 200);\n                        setTimeout(function () {\n                            $('#seekhead').removeClass('active');\n                        }, 1000);\n                        let percentage = ui.position.left / $('#video-nav').width();\n                        replaceProgressBars(percentage * 100);\n                        player.play();\n                    }\n                });\n            };\n\n            const onPaused = () => {\n                if (!playerReady) {\n                    return;\n                }\n                clearInterval(interval);\n                $('#playpause').find('i').removeClass('bi-pause-fill').addClass('bi-play-fill');\n                $('#playpause').attr('data-original-title', M.util.get_string('play', 'mod_interactivevideo'));\n            };\n\n            const onEnded = (t) => {\n                if (!playerReady) {\n                    return;\n                }\n                const time = t || end;\n                // Check if theAnnotation exists at the end of the video.\n                const theAnnotation = releventAnnotations.find(x => x.timestamp == time);\n                if (theAnnotation && !lastanno) {\n                    if (!theAnnotation.completed || theAnnotation.rerunnable) {\n                        player.pause();\n                        runInteraction(theAnnotation);\n                    }\n                    // Toggle the tooltip to show the title.\n                    $videoNav.find('.annotation[data-id=\"' + theAnnotation.id + '\"] .item').tooltip('show');\n                    // Hide the tooltip after 2 seconds.\n                    setTimeout(function () {\n                        $videoNav.find('.annotation[data-id=\"' + theAnnotation.id + '\"] .item').tooltip('hide');\n                    }, 2000);\n                }\n\n                $('#restart').removeClass('d-none').fadeIn(300);\n                $('#end-screen').removeClass('d-none').fadeIn(300);\n                $('#progress').css('width', '100%');\n                $('#seekhead').css('left', '100%');\n                clearInterval(interval);\n                player.pause();\n                $('#playpause').find('i').removeClass('bi-pause-fill').addClass('bi-play-fill');\n                $('#playpause').attr('data-original-title', M.util.get_string('play', 'mod_interactivevideo'));\n            };\n\n            const onSeek = async (t) => {\n                if (!playerReady) {\n                    return;\n                }\n                if (t) {\n                    t = Number(t);\n                } else {\n                    t = await player.getCurrentTime();\n                }\n                if (t > start && t < end) {\n                    $('#end-screen, #start-screen').addClass('d-none');\n                }\n                var percentage = (t - start) / (totaltime) * 100;\n                $('#currenttime').text(convertSecondsToHMS(t - start));\n                replaceProgressBars(percentage);\n            };\n\n            let interval;\n            const onPlaying = async () => { // Use with player timeupdate event.\n                // Reset the annotation content.\n                if (!playerReady) {\n                    return;\n                }\n                if ($('body').hasClass('mobiletheme') && !$('#wrapper').hasClass('fullscreen')) {\n                    $(\"#fullscreen\").trigger('click');\n                }\n                $('#annotation-modal').modal('hide');\n                $('#message').not('[data-placement=bottom]').not('.sticky').remove();\n                $('#end-screen, #start-screen').fadeOut(300);\n                $('#restart').addClass('d-none');\n                $('#playpause').find('i').removeClass('bi-play-fill').addClass('bi-pause-fill');\n                $('#playpause').attr('data-original-title', M.util.get_string('pause', 'mod_interactivevideo'));\n                const intervalFunction = async function () {\n                    const isPlaying = await player.isPlaying();\n                    const isEnded = await player.isEnded();\n                    if (!isPlaying || isEnded) {\n                        clearInterval(interval);\n                        return;\n                    }\n\n                    const t = await player.getCurrentTime();\n                    if (t > end || isEnded) {\n                        clearInterval(interval);\n                        onEnded(end);\n                        return;\n                    }\n\n                    dispatchEvent('timeupdate', { 'time': t });\n\n                    const time = Math.round(t);\n\n                    // If it is the same annotation we just run, then we don't need to run it again.\n                    if (lastanno && time == lastanno.timestamp) {\n                        return;\n                    } else {\n                        if (lastanno && time > lastanno.timestamp) {\n                            lastanno = null;\n                        }\n                        let percentagePlayed = (t - start) / totaltime;\n                        $('#currenttime').text(convertSecondsToHMS(t - start));\n                        percentagePlayed = percentagePlayed > 1 ? 1 : percentagePlayed;\n                        $('#video-nav #progress').css('width', percentagePlayed * 100 + '%');\n                        $('#video-nav #seekhead').css('left', percentagePlayed * 100 + '%');\n                        const theAnnotation = releventAnnotations.find(x => (((t - player.frequency) <= x.timestamp\n                            && (t + player.frequency) >= x.timestamp) || time == x.timestamp) && x.id != 0);\n                        if (theAnnotation) {\n                            if (theAnnotation.completed && !theAnnotation.rerunnable) {\n                                $('#video-nav .annotation[data-id=\"' + theAnnotation.id + '\"] .item').tooltip('show');\n                                setTimeout(function () {\n                                    $('#video-nav .annotation[data-id=\"' + theAnnotation.id + '\"] .item').tooltip('hide');\n                                }, 2000);\n                            } else {\n                                player.pause();\n                                $('#video-nav #progress')\n                                    .css('width', (theAnnotation.timestamp - start) / totaltime * 100 + '%');\n                                $('#video-nav #seekhead').css('left', (theAnnotation.timestamp - start) / totaltime * 100 + '%');\n                                runInteraction(theAnnotation);\n                            }\n                        }\n                    }\n\n                    // Pause video on spacebar pressed\n                    $(document).on('keydown', function (e) {\n                        if (e.keyCode == 32) {\n                            e.preventDefault();\n                            player.pause();\n                        }\n                    });\n                };\n\n                if (player.type == 'yt' || player.type == 'wistia') {\n                    interval = setInterval(intervalFunction, player.frequency * 100);\n                } else {\n                    intervalFunction();\n                }\n\n            };\n\n            // Implement the player\n            require(['mod_interactivevideo/player/' + vtype], function (VideoPlayer) {\n                player = new VideoPlayer(\n                    url,\n                    start,\n                    end,\n                    displayoptions.useoriginalvideocontrols == 1,\n                    true,\n                    false\n                );\n            });\n\n            // Move toast-wrapper to the #wrapper element so it can be displayed on top of the video in fullscreen mode.\n            let $toast = $('.toast-wrapper').detach();\n            $('#wrapper').append($toast);\n\n            $(document).on('timeupdate', async function (e) {\n                const t = e.originalEvent.detail.time;\n                if (preventskip) {\n                    const theAnnotations = releventAnnotations.filter(x => Number(x.timestamp) <= (t + player.frequency)\n                        && x.completed == false && JSON.parse(x.prop).hascompletion == true);\n                    if (theAnnotations.length > 0) {\n                        const theAnnotation = theAnnotations[0];\n                        player.pause();\n                        await player.seek((theAnnotation.timestamp - 0.7 > start) ? (theAnnotation.timestamp - 0.7) : start);\n                        clearInterval(interval);\n                        Toast.add(M.util.get_string('youmustcompletethepreviousactivity', 'mod_interactivevideo'), {\n                            type: 'danger'\n                        });\n                        $videoNav.find('#progress').css('width', ((theAnnotation.timestamp - start) / totaltime) * 100 + '%');\n                        $videoNav.find('#seekhead').css('left', ((theAnnotation.timestamp - start) / totaltime) * 100 + '%');\n                    }\n                }\n            });\n\n            // Handle the refresh button:: allowing user to refresh the content\n            $(document).on('click', '#refresh', function (e) {\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                const id = $(this).data('id');\n                const annotation = releventAnnotations.find(x => x.id == id);\n                $(this).closest('#message').find(\"#content\").empty();\n                runInteraction(annotation, true);\n            });\n\n            // Handle video control events:: fullscreen toggle\n            $(document).on('click', '#fullscreen', function (e) {\n                e.preventDefault();\n                if (!playerReady) {\n                    return;\n                }\n\n                // Put the wrapper in fullscreen mode\n                let elem = document.getElementById('wrapper');\n                $('#fullscreen').toggleClass('active');\n                if (!$('#wrapper').hasClass('fullscreen')) {\n                    if (elem.requestFullscreen) {\n                        elem.requestFullscreen();\n                    } else if (elem.mozRequestFullScreen) { /* Firefox */\n                        elem.mozRequestFullScreen();\n                    } else if (elem.webkitRequestFullscreen) { /* Chrome, Safari and Opera */\n                        elem.webkitRequestFullscreen();\n                    } else if (elem.msRequestFullscreen) { /* IE/Edge */\n                        elem.msRequestFullscreen();\n                    }\n                } else {\n                    if (document.exitFullscreen) {\n                        document.exitFullscreen();\n                    } else if (document.mozCancelFullScreen) { /* Firefox */\n                        document.mozCancelFullScreen();\n                    } else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */\n                        document.webkitExitFullscreen();\n                    } else if (document.msExitFullscreen) { /* IE/Edge */\n                        document.msExitFullscreen();\n                    }\n                }\n            });\n\n            $(document).on('fullscreenchange', function () {\n                if (document.fullscreenElement) {\n                    $('#wrapper, #interactivevideo-container').addClass('fullscreen');\n                    $(\"#video-wrapper\").css('padding-bottom', '0');\n                } else {\n                    $('#wrapper, #interactivevideo-container').removeClass('fullscreen');\n                    player.ratio().then((ratio) => {\n                        $(\"#video-wrapper\").css('padding-bottom', (1 / ratio) * 100 + '%');\n                    });\n                }\n                $('#wrapper #fullscreen i').toggleClass('bi-fullscreen bi-fullscreen-exit');\n            });\n\n            // Pause video when the tab is not visible.\n            $(document).on('visibilitychange', function () {\n                if (document.visibilityState == 'hidden') {\n                    player.pause();\n                }\n            });\n\n            // Handle share this moment event.\n            $(document).on('click', '#controler #share', function (e) {\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                const $this = $(this);\n                $this.find('i').toggleClass('bi-share-fill bi-share');\n                player.getCurrentTime().then((time) => {\n                    const url = window.location.href;\n                    const shareurl = url + (url.indexOf('?') > 0 ? '&' : '?') + 't=' + Math.round(time);\n                    // Add shareurl to clipboard.\n                    navigator.clipboard.writeText(shareurl).then(function () {\n                        // Show the copied message.\n                        // Change tooltip to copied.\n                        $this.attr('data-original-title', M.util.get_string(\"copied\", \"mod_interactivevideo\")).tooltip('show');\n                        setTimeout(function () {\n                            // Change tooltip back to share.\n                            $this\n                                .attr('data-original-title', M.util.get_string(\"sharethismoment\", \"mod_interactivevideo\"))\n                                .tooltip('hide');\n                            $this.find('i').toggleClass('bi-share-fill bi-share');\n                        }, 2000);\n                    });\n                });\n            });\n\n            // Display time when user hover on the progress bar.\n            $(document).on('mouseenter', '#video-nav #seek', function (e) {\n                if (!playerReady) {\n                    return;\n                }\n                $(this).append('<div id=\"position\"><div id=\"timelabel\"></div></div>');\n                let $position = $('#position');\n                const parentOffset = $(this).offset();\n                const relX = e.pageX - parentOffset.left;\n\n                $position.css('left', (relX + 3) + 'px');\n                var percentage = relX / $(this).width();\n                var time = Math.round(percentage * end);\n                var formattedTime = convertSecondsToHMS(time);\n                $position.find('#timelabel').text(formattedTime);\n            });\n\n            $(document).on('mousemove', '#video-nav #seek', function (e) {\n                if (!playerReady) {\n                    return;\n                }\n                const parentOffset = $(this).offset();\n                const relX = e.pageX - parentOffset.left;\n                var percentage = relX / $(this).width();\n                var time = Math.round(percentage * end);\n                var formattedTime = convertSecondsToHMS(time);\n                $('#position').css('left', (relX + 3) + 'px');\n                $('#position #timelabel').text(formattedTime);\n            });\n\n            $(document).on('mouseleave', '#video-nav #seek', function () {\n                $('#position').remove();\n            });\n\n            // Handle annotation click event:: when user click on the annotation on the progress bar\n            $(document).on('click', '#video-nav .annotation', async function (e) {\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                if ($(this).hasClass('no-click')) {\n                    // Add a tooltip that seeking is disabled.\n                    Toast.add(M.util.get_string('youcannotviewthisannotationyet', 'mod_interactivevideo'), {\n                        type: 'danger'\n                    });\n                    return;\n                }\n                const timestamp = $(this).data('timestamp');\n                player.play();\n                if (player.type == 'yt') {\n                    clearInterval(interval);\n                }\n                await player.seek(Number(timestamp));\n                replaceProgressBars(((timestamp - start) / totaltime) * 100);\n                const id = $(this).data('id');\n                const theAnnotation = releventAnnotations.find(x => x.id == id);\n                runInteraction(theAnnotation);\n                lastanno = theAnnotation;\n            });\n\n            // Handle seeking event:: when user click on the progress bar\n            $(document).on('click', '#video-nav', async function (e) {\n                if (!playerReady) {\n                    return;\n                }\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                if ($(this).hasClass('no-click')) {\n                    // Add a tooltip that seeking is disabled.\n                    Toast.add(M.util.get_string('seekingdisabled', 'mod_interactivevideo'), {\n                        type: 'danger'\n                    });\n                    return;\n                }\n                lastanno = null;\n                $('#start-screen').fadeOut(300);\n                $('#end-screen').fadeOut(300);\n                const parentOffset = $(this).offset();\n                const relX = e.pageX - parentOffset.left;\n                var percentage = relX / $(this).width();\n                // Gotta check if this affects anything.\n                if (player.type == 'yt') {\n                    clearInterval(interval);\n                }\n                player.pause(); // Especially for vimeo.\n                await player.seek((percentage * totaltime) + start);\n                replaceProgressBars(percentage * 100);\n                player.play();\n\n            });\n\n            // Handle video control events:: play\n            $(document).on('click', '#start-screen #play', async function (e) {\n                e.preventDefault();\n                $('#start-screen').fadeOut(300);\n                $(this).addClass('d-none');\n                $videoNav.removeClass('d-none');\n                await player.seek(start);\n                player.play();\n            });\n\n            // Handle video control events:: restart\n            $(document).on('click', '#end-screen #restart', async function (e) {\n                e.preventDefault();\n                $('#message').remove();\n                lastanno = null;\n                await player.seek(start);\n                $videoNav.find(\"#progress\").css('width', '0%');\n                $videoNav.find(\"#seekhead\").css('left', '0%');\n                $('#end-screen').fadeOut(300);\n                $(this).addClass('d-none');\n                $videoNav.removeClass('d-none');\n                replaceProgressBars(0);\n                player.play();\n            });\n\n            // Handle video control events:: pause/resume when user click on the video\n            $(document).on('click', '#video-wrapper .video-block', async function (e) {\n                if (!playerReady) {\n                    return;\n                }\n                clearInterval(interval);\n                e.preventDefault();\n                // Pause or resume the video.\n                player.isPlaying().then(async (playing) => {\n                    if (playing) {\n                        player.pause();\n                    } else {\n                        player.play();\n                    }\n                });\n            });\n\n            $(document).on('click', '#playpause', function (e) {\n                if (!playerReady) {\n                    return;\n                }\n                e.preventDefault();\n                $(this).tooltip('hide');\n                // Pause or resume the video.\n                player.isPlaying().then(async (playing) => {\n                    if (playing) {\n                        player.pause();\n                    } else {\n                        let t = await player.getCurrentTime();\n                        if (t >= end) {\n                            $('#end-screen #restart').trigger('click');\n                        } else {\n                            player.play();\n                        }\n                    }\n                });\n            });\n\n            $(document).on('click', 'li.anno', async function (e) {\n                e.preventDefault();\n                const id = $(this).data('id');\n                $(`li.annotation[data-id=${id}]`).trigger('click');\n                if ($(this).closest('#chapter-container-left').length > 0) {\n                    $('#chaptertoggle .btn').trigger('click');\n                }\n            });\n\n            $(document).on('click', '#mute', function (e) {\n                e.preventDefault();\n                $(this).tooltip('hide');\n                $(this).toggleClass('active');\n                if ($(this).hasClass('active')) {\n                    player.mute();\n                    $(this).attr('data-original-title', M.util.get_string('unmute', 'mod_interactivevideo'));\n                } else {\n                    player.unMute();\n                    $(this).attr('data-original-title', M.util.get_string('mute', 'mod_interactivevideo'));\n                }\n                $(this).find('i').toggleClass('bi-volume-mute bi-volume-up');\n                $(this).tooltip('show');\n            });\n\n            $(document).on('click', '.changerate', function (e) {\n                e.preventDefault();\n                const rate = $(this).data('rate');\n                player.setRate(rate);\n                $('.changerate').find('i').removeClass('bi-check');\n                $(this).find('i').addClass('bi-check');\n            });\n\n            $(document).on('click', '#changequality', async function () {\n                let quality = await player.getQualities();\n                $('#qualitieslist').empty();\n                let currentQuality = quality.currentQuality;\n                let qualities = quality.qualities;\n                qualities.forEach(q => {\n                    $('#qualitieslist').append(`<a class=\"dropdown-item text-white changequality\" data-quality=\"${q}\"\n                         href=\"#\"><i class=\"bi ${q == currentQuality ? 'bi-check': ''} fa-fw ml-n3\"></i>${q}</a>`);\n                });\n                // Update the dropdown element.\n                $('#changequality').dropdown('update');\n            });\n\n            $(document).on('click', '.changequality', function (e) {\n                e.preventDefault();\n                const quality = $(this).data('quality');\n                player.setQuality(quality);\n                $('.changequality').find('i').removeClass('bi-check');\n                $(this).find('i').addClass('bi-check');\n            });\n\n            $(document).on('interactionrun', function (e) {\n                window.console.log(e);\n            });\n\n            $(document).on('interactionclose', function (e) {\n                window.console.log(e);\n            });\n\n            $(document).on('interactionCompletionUpdated', function (e) {\n                window.console.log(e);\n            });\n\n            $(document).on('iv:playerReady', function () {\n                onReady();\n            });\n\n            $(document).on('iv:playerPaused', function () {\n                onPaused();\n            });\n\n            $(document).on('iv:playerPlaying', function () {\n                onPlaying();\n            });\n\n            $(document).on('iv:playerEnded', function () {\n                onEnded();\n            });\n\n            $(document).on('iv:playerSeek', function (e) {\n                onSeek(e.detail.time);\n            });\n\n            $(document).on('iv:playerError', function () {\n                Toast.add(M.util.get_string('thereisanissueloadingvideo', 'mod_interactivevideo'), {\n                    type: 'danger'\n                });\n                $('#spinner').remove();\n            });\n\n            $(document).on('iv:playerRateChange', function (e) {\n                $('.changerate').find('i').removeClass('bi-check');\n                $(`.changerate[data-rate=\"${e.originalEvent.detail.rate}\"]`).find('i').addClass('bi-check');\n            });\n        }\n    };\n});"],"names":["define","$","Toast","annotations","totaltime","activityType","lastanno","contentTypes","displayoptions","releventAnnotations","player","dispatchEvent","ctRenderer","$videoNav","renderAnnotationItems","async","annos","start","actualduration","skipsegments","filter","x","type","length","forEach","Number","title","timestamp","completableAnno","JSON","parse","prop","hascompletion","actualAnnotationCounts","xp","map","reduce","a","b","completedAnnos","completed","xpEarned","seconds","empty","append","Math","ceil","floor","preventseeking","addClass","hidemainvideocontrols","hideinteractions","Promise","resolve","renderItemOnVideoNavigation","then","chapteritems","sort","each","cstart","this","data","cend","find","id","icon","formattedtitle","document","on","tooltip","container","boundary","disableinteractionclickuntilcompleted","disableinteractionclick","init","url","cmid","interaction","course","userid","end","completionpercentage","gradeiteminstance","grademax","vtype","preventskip","moment","doptions","token","isNaN","playerReady","convertSecondsToHMS","h","m","s","replaceProgressBars","percentage","replaceWith","css","getAnnotations","callback","annnoitems","ajax","M","cfg","wwwroot","method","dataType","action","sesskey","contextid","courseContextId","userprogress","uid","getContentTypes","when","done","progress","ct","some","y","name","completedItems","completeditems","stringify","indexOf","advanced","rerunnable","replaybehavior","shouldAdd","push","unshift","util","get_string","hide","chapterContentType","includes","remove","removeClass","count","require","amdmodule","Type","error","toggleClass","runInteraction","annotation","modal","not","fadeOut","theAnnotations","theAnnotation","pause","seek","add","shareMoment","urlParams","URLSearchParams","window","location","search","time","play","delete","newurl","protocol","host","pathname","toString","history","replaceState","onReady","support","playbackrate","quality","posterImage","getDuration","duration","min","text","ratio","focus","draggable","event","ui","position","left","width","setTimeout","onPaused","clearInterval","interval","attr","onEnded","t","fadeIn","onSeek","getCurrentTime","onPlaying","hasClass","trigger","intervalFunction","isPlaying","isEnded","round","percentagePlayed","frequency","e","keyCode","preventDefault","setInterval","VideoPlayer","useoriginalvideocontrols","$toast","detach","originalEvent","detail","stopImmediatePropagation","closest","elem","getElementById","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","fullscreenElement","visibilityState","$this","href","shareurl","navigator","clipboard","writeText","$position","parentOffset","offset","relX","pageX","formattedTime","playing","mute","unMute","rate","setRate","getQualities","currentQuality","qualities","q","dropdown","setQuality","console","log"],"mappings":"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"}