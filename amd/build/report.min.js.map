{"version":3,"file":"report.min.js","sources":["../src/report.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle report page\n *\n * @module     mod_interactivevideo/report\n * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport $ from 'jquery';\nimport Notification from 'core/notification';\nimport {add as addToast} from 'core/toast';\nimport JSZip from 'mod_interactivevideo/libraries/jszip';\nimport 'mod_interactivevideo/libraries/jquery.dataTables';\nimport 'mod_interactivevideo/libraries/dataTables.bootstrap4';\nimport 'mod_interactivevideo/libraries/dataTables.buttons';\nimport 'mod_interactivevideo/libraries/buttons.bootstrap4';\nimport 'mod_interactivevideo/libraries/buttons.html5';\n\n/**\n * Initializes the report functionality for the interactive video module.\n *\n * @param {number} cmid - The course module ID.\n * @param {number} groupid - The group ID.\n * @param {number} grademax - The maximum grade.\n * @param {Array} itemids - The annotation IDs.\n * @param {number} completionpercentage - The completion percentage.\n * @param {string} videourl - The video URL.\n * @param {string} videotype - The video type.\n * @param {Object} cm - The course module object.\n * @param {number} courseid - The course ID.\n * @param {number} start - The start time.\n * @param {number} end - The end time.\n */\nconst init = (cmid, groupid, grademax, itemids, completionpercentage, videourl, videotype, cm, courseid, start, end) => {\n    window.JSZip = JSZip;\n\n    let player;\n\n    const getContentTypes = $.ajax({\n        url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n        method: \"POST\",\n        dataType: \"text\",\n        data: {\n            action: 'get_all_contenttypes',\n            sesskey: M.cfg.sesskey,\n            contextid: M.cfg.contextid,\n        }\n    });\n\n    const getReportData = $.ajax({\n        url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n        method: 'POST',\n        data: {\n            action: 'get_report_data_by_group',\n            cmid: cmid,\n            sesskey: M.cfg.sesskey,\n            contextid: M.cfg.contextid,\n            ctxid: M.cfg.courseContextId,\n            groupid: groupid\n        }\n    });\n\n    let itemsdata = $('#itemsdata').text();\n    itemsdata = JSON.parse(itemsdata);\n\n    let contentTypes;\n    let tabledata;\n    $.when(getContentTypes, getReportData).done(async (ct, data) => {\n        contentTypes = JSON.parse(ct[0]);\n        data = data[0];\n\n        let datatableOptions = {\n            \"data\": data,\n            \"deferRender\": true,\n            \"rowId\": \"id\",\n            \"pageLength\": 25,\n            \"order\": [[1, \"asc\"]],\n            \"columns\": [\n                {\n                    data: \"id\",\n                    visible: false\n                },\n                {\n                    data: \"picture\",\n                    render: function(data, type, row) {\n                        let deletebutton = `<button title=\"${M.util.get_string('reset', 'mod_interactivevideo')}\"\n                         class=\"btn border-0 btn-sm text-danger reset m-1\" data-record=\"${row.completionid}\"\n                          data-userid=\"${row.id}\">\n                         <i class=\"bi bi-trash3\"></i></button>`;\n                        return `<div class=\"text-truncate d-flex align-items-center justify-content-between\">${data}\n                        ${row.timecreated > 0 ? deletebutton : ''}</div>`;\n                    },\n                    className: \"bg-white sticky-left-0\",\n                },\n                {\n                    data: \"firstname\",\n                    className: \"exportable\"\n                },\n                {\n                    data: \"lastname\",\n                    className: \"exportable\"\n                },\n                {\n                    data: \"email\",\n                    className: \"exportable\"\n                },\n                {\n                    data: \"timecreated\",\n                    \"render\": function(data, type) {\n                        if (!data || data == 0) {\n                            if (type === 'display') {\n                                return M.util.get_string('notstarted', 'mod_interactivevideo');\n                            } else {\n                                return 0;\n                            }\n                        } else {\n                            const date = new Date(data * 1000);\n                            if (type === 'display') {\n                                return date.toLocaleString();\n                            } else if (type === 'filter' || type === 'sort') {\n                                return date.getTime();\n                            }\n                            return data;\n                        }\n                    },\n                    className: \"exportable\"\n                },\n                {\n                    data: \"timecompleted\",\n                    render: function(data, type, row) {\n                        if (!data || data == 0) {\n                            if (!row.timecreated) {\n                                return '';\n                            } else {\n                                if (type === 'display') {\n                                    return M.util.get_string('inprogress', 'mod_interactivevideo');\n                                } else {\n                                    return 0;\n                                }\n                            }\n                        } else {\n                            const date = new Date(data * 1000);\n                            if (type === 'display') {\n                                return date.toLocaleString();\n                            } else if (type === 'filter' || type === 'sort') {\n                                return date.getTime();\n                            }\n                            return data;\n                        }\n                    },\n                    className: \"exportable\"\n                },\n                {\n                    data: \"completionpercentage\",\n                    render: function(data) {\n                        if (data) {\n                            return data + \"%\";\n                        } else {\n                            return \"\";\n                        }\n                    },\n                    className: \"exportable\"\n                },\n                {\n                    data: \"xp\",\n                    render: function(data) {\n                        if (data) {\n                            return data;\n                        } else {\n                            return \"\";\n                        }\n                    },\n                    className: \"exportable\"\n                }\n            ],\n            \"language\": {\n                \"lengthMenu\": \"_MENU_\",\n                \"zeroRecords\": M.util.get_string('nofound', \"mod_interactivevideo\"),\n                \"search\": `<span class=\"d-none d-md-inline\">${M.util.get_string('search', \"mod_interactivevideo\")}</span>`,\n                \"info\": M.util.get_string('datatableinfo', \"mod_interactivevideo\"),\n                \"infoEmpty\": M.util.get_string('datatableinfoempty', \"mod_interactivevideo\"),\n                \"infoFiltered\": M.util.get_string('datatableinfofiltered', \"mod_interactivevideo\"),\n                \"paginate\": {\n                    \"first\": M.util.get_string('first', 'mod_interactivevideo'),\n                    \"last\": M.util.get_string('last', 'mod_interactivevideo'),\n                    \"next\": M.util.get_string('next', 'mod_interactivevideo'),\n                    \"previous\": M.util.get_string('previous', 'mod_interactivevideo')\n                }\n            },\n            stateSaveParams: function(settings, data) {\n                // We only want to save the state of the colvis and length menu\n                data.search.search = \"\";\n                data.start = 0;\n                data.columns.forEach(function(column) {\n                    column.search.search = \"\";\n                });\n                return data;\n            },\n            stateSave: true,\n            \"dom\": `<'d-flex w-100 justify-content-between`\n                + `'<'d-flex align-items-start'Bl>'<''f>>t<'row mt-2'<'col-sm-6'i><'col-sm-6'p>>`,\n            \"buttons\": [\n                {\n                    extend: \"copyHtml5\",\n                    text: '<i class=\"bi bi-copy fa-fw fs-unset\"></i>',\n                    className: \"btn btn-sm border-0\",\n                    messageTop: null,\n                    title: null,\n                    exportOptions: {\n                        columns: ['.exportable'],\n                        format: {\n                            body: function(data) {\n                                // Strip HTML tags to get text only\n                                const div = document.createElement(\"div\");\n                                div.innerHTML = data;\n                                return (div.textContent || div.innerText || \"\").trim();\n                            }\n                        }\n                    }\n                },\n                {\n                    extend: \"csvHtml5\",\n                    text: '<i class=\"bi bi-filetype-csv fa-fw fs-unset\"></i>',\n                    className: \"btn btn-sm border-0\",\n                    exportOptions: {\n                        columns: ['.exportable'],\n                        format: {\n                            body: function(data) {\n                                // Strip HTML tags to get text only\n                                const div = document.createElement(\"div\");\n                                div.innerHTML = data;\n                                return (div.textContent || div.innerText || \"\").trim();\n                            }\n                        }\n                    }\n                },\n                {\n                    extend: \"excelHtml5\",\n                    text: '<i class=\"bi bi-file-earmark-excel fa-fw fs-unset\"></i>',\n                    className: \"btn btn-sm border-0\",\n                    exportOptions: {\n                        columns: ['.exportable'],\n                        format: {\n                            body: function(data) {\n                                // Strip HTML tags to get text only\n                                const div = document.createElement(\"div\");\n                                div.innerHTML = data;\n                                return (div.textContent || div.innerText || \"\").trim();\n                            }\n                        }\n                    }\n                }\n            ],\n            \"initComplete\": function() {\n                $(\"table#completiontable\")\n                    .wrap(\"<div style='overflow:auto;position:relative' class='completiontablewrapper'></div>\");\n                $(\"#reporttable .dataTables_length \").addClass(\"d-inline ml-1\");\n                $(\"#reporttable .dataTables_filter\").addClass(\"d-inline float-right\");\n                $(\"#reporttable .table-responsive\").addClass(\"p-1\");\n                $(\"#reporttable .spinner-grow\").remove();\n                $(\"table#completiontable\").removeClass(\"d-none\");\n\n            }\n        };\n\n        $(\"#reporttable th.rotate\").each(function() {\n            const itemid = $(this).data(\"item\").toString();\n            const ctype = $(this).data(\"type\");\n            datatableOptions.columns.push({\n                data: null,\n                sortable: false,\n                className: \"text-center exportable\",\n                render: function(data, rtype, row) {\n                    let completiondetails;\n                    try {\n                        completiondetails = JSON.parse(data.completiondetails).map(x => JSON.parse(x));\n                    } catch (e) {\n                        completiondetails = [];\n                    }\n                    let details = completiondetails.find(x => Number(x.id) == Number(itemid));\n                    if (details) {\n                        return `<span class=\"completion-detail ${details.hasDetails ? 'cursor-pointer' : ''}\"\n                                 data-id=\"${itemid}\" data-userid=\"${row.id}\" data-type=\"${ctype}\">${details.reportView}</span>`;\n                    } else {\n                        return '-';\n                    }\n                },\n            });\n        });\n\n        tabledata = $('#completiontable').DataTable(datatableOptions);\n    });\n\n    $(document).on('click', '[data-item] a', function() {\n        const convertSecondsToHMS = (seconds) => {\n            const h = Math.floor(seconds / 3600);\n            const m = Math.floor(seconds % 3600 / 60);\n            const s = Math.floor(seconds % 3600 % 60);\n            return (h > 0 ? h + ':' : '') + (m < 10 ? '0' : '') + m + ':' + (s < 10 ? '0' : '') + s;\n        };\n        let annotationid = $(this).closest('th').data('item');\n        let theAnnotation = itemsdata.find(x => x.id == annotationid);\n        let tabledatajson = tabledata.rows().data().toArray();\n        let title = theAnnotation.formattedtitle;\n        if (theAnnotation.timestamp > 0) {\n            title += \" @ \" + convertSecondsToHMS(theAnnotation.timestamp);\n        }\n        const modal = `<div class=\"modal fade\" id=\"annotation-modal\" role=\"dialog\"\n            aria-labelledby=\"annotation-modal\"\n         aria-hidden=\"true\" data-backdrop=\"static\" data-keyboard=\"false\">\n         <div id=\"message\" data-id=\"${theAnnotation.id}\" data-placement=\"popup\"\n          class=\"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable ${theAnnotation.type}\" role=\"document\">\n            <div class=\"modal-content rounded-lg\">\n                <div class=\"modal-header d-flex align-items-center shadow-sm\" id=\"title\">\n                    <h5 class=\"modal-title text-truncate mb-0\">${title}</h5>\n                    <div class=\"btns d-flex align-items-center\">\n                        <button class=\"btn close-modal p-0 border-0\" aria-label=\"Close\" data-dismiss=\"modal\">\n                        <i class=\"bi bi-x-lg fa-fw fs-25px\"></i>\n                        </button>\n                    </div>\n                </div>\n                <div class=\"modal-body\" id=\"content\">\n                <div class=\"loader w-100 mt-5\"></div>\n                </div>\n                </div>\n            </div>\n            </div>`;\n        $('body').append(modal);\n        $('#annotation-modal').modal('show');\n        $('#annotation-modal').on('hide.bs.modal', function() {\n            $('#annotation-modal').remove();\n        });\n\n        $('#annotation-modal').on('shown.bs.modal', function() {\n            $('#annotation-modal .modal-body').fadeIn(300);\n            let matchingContentTypes = contentTypes.find(x => x.name === theAnnotation.type);\n            let amdmodule = matchingContentTypes.amdmodule;\n            require([amdmodule], function(Module) {\n                theAnnotation.completed = true;\n                new Module(player, itemsdata, cmid, courseid, null,\n                    completionpercentage, null, grademax, videotype, null,\n                    end - start, start, end, theAnnotation.prop, cm).displayReportView(theAnnotation, tabledatajson);\n            });\n            $(this).find('.close-modal').focus();\n        });\n    });\n\n    $(document).on('click', 'td .reset', function(e) {\n        e.preventDefault();\n        const recordid = $(this).data('record');\n        let $this = $(this);\n        try {\n            Notification.deleteCancelPromise(\n                M.util.get_string('deletecompletion', 'mod_interactivevideo'),\n                M.util.get_string('areyousureyouwanttoresetthecompletiondata', 'mod_interactivevideo'),\n                M.util.get_string('delete', 'mod_interactivevideo')\n            ).then(() => {\n                return $.ajax({\n                    url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n                    method: 'POST',\n                    dataType: \"text\",\n                    data: {\n                        action: 'delete_progress_by_id',\n                        recordid,\n                        courseid: courseid,\n                        cmid: cmid,\n                        contextid: M.cfg.contextid,\n                        sesskey: M.cfg.sesskey,\n                    },\n                    success: function(response) {\n                        window.console.log(response);\n                        if (response == 'deleted') {\n                            let targetdata = tabledata.row($this.closest('tr')).data();\n                            targetdata.completionpercentage = 0;\n                            targetdata.timecompleted = 0;\n                            targetdata.xp = 0;\n                            targetdata.timecreated = 0;\n                            targetdata.completeditems = null;\n                            targetdata.completiondetails = null;\n                            targetdata.completionid = null;\n                            tabledata.row($this.closest('tr')).data(targetdata).draw();\n                            addToast(M.util.get_string('completionresetsuccess', 'mod_interactivevideo'), {\n                                type: 'success'\n                            });\n                        }\n                    },\n                    error: function(e) {\n                        window.console.log(e);\n                        addToast(M.util.get_string('completionreseterror', 'mod_interactivevideo'), {\n                            type: 'error'\n                        });\n                    }\n                });\n            }).catch(() => {\n                return;\n            });\n        } catch { // Fallback for older versions of Moodle.\n            Notification.saveCancel(\n                M.util.get_string('deletecompletion', 'mod_interactivevideo'),\n                M.util.get_string('areyousureyouwanttoresetthecompletiondata', 'mod_interactivevideo'),\n                M.util.get_string('delete', 'mod_interactivevideo'),\n                function() {\n                    return $.ajax({\n                        url: M.cfg.wwwroot + '/mod/interactivevideo/ajax.php',\n                        method: 'POST',\n                        dataType: \"text\",\n                        data: {\n                            action: 'delete_progress_by_id',\n                            recordid,\n                            contextid: M.cfg.contextid,\n                            sesskey: M.cfg.sesskey,\n                        },\n                        success: function(response) {\n                            if (response == 'deleted') {\n                                let targetdata = tabledata.row($this.closest('tr')).data();\n                                targetdata.completionpercentage = 0;\n                                targetdata.timecompleted = 0;\n                                targetdata.xp = 0;\n                                targetdata.timecreated = 0;\n                                targetdata.completeditems = null;\n                                targetdata.completiondetails = null;\n                                targetdata.completionid = null;\n                                tabledata.row($this.closest('tr')).data(targetdata).draw();\n                                addToast(M.util.get_string('completionresetsuccess', 'mod_interactivevideo'), {\n                                    type: 'success'\n                                });\n                            }\n                        },\n                        error: function() {\n                            addToast(M.util.get_string('completionreseterror', 'mod_interactivevideo'), {\n                                type: 'error'\n                            });\n                        }\n                    });\n                }\n            );\n        }\n    });\n\n    $(document).on('click', 'td .completion-detail', function() {\n        let id = $(this).data('id');\n        let userid = $(this).data('userid');\n        let type = $(this).data('type');\n        let matchingContentTypes = contentTypes.find(x => x.name === type);\n        let amdmodule = matchingContentTypes.amdmodule;\n        // Get column header with the item id.\n        let theAnnotation = itemsdata.find(x => x.id == id);\n        require([amdmodule], function(Module) {\n            new Module(player, itemsdata, cmid, courseid, null,\n                completionpercentage, null, grademax, videotype, null,\n                end - start, start, end, theAnnotation.prop, cm).getCompletionData(theAnnotation, userid);\n        });\n    });\n};\n\n\n/**\n * Renders annotation logs in a DataTable with specified options.\n *\n * @param {Object} data - The data to be displayed in the table.\n * @param {Array} data.rows - The rows of data to be displayed.\n * @param {string} node - The DOM node selector where the table will be rendered.\n * @param {string} title - The title used for export options.\n */\nconst renderAnnotationLogs = (data, node, title) => {\n    let tableOptions = {\n        \"data\": data.rows,\n        \"deferRender\": true,\n        \"pageLength\": 25,\n        \"order\": [[0, \"asc\"]],\n        \"columnDefs\": [\n            {\n                \"targets\": 'not-sortable',\n                \"sortable\": false,\n            },\n        ],\n        \"language\": {\n            \"lengthMenu\": \"_MENU_\",\n            \"zeroRecords\": M.util.get_string('nofound', \"mod_interactivevideo\"),\n            \"search\": M.util.get_string('search', \"mod_interactivevideo\"),\n            \"info\": M.util.get_string('datatableinfo', \"mod_interactivevideo\"),\n            \"infoEmpty\": M.util.get_string('datatableinfoempty', \"mod_interactivevideo\"),\n            \"infoFiltered\": M.util.get_string('datatableinfofiltered', \"mod_interactivevideo\"),\n            \"paginate\": {\n                \"first\": M.util.get_string('first', 'mod_interactivevideo'),\n                \"last\": M.util.get_string('last', 'mod_interactivevideo'),\n                \"next\": M.util.get_string('next', 'mod_interactivevideo'),\n                \"previous\": M.util.get_string('previous', 'mod_interactivevideo')\n            }\n        },\n        stateSaveParams: function(settings, data) {\n            // We only want to save the state of the colvis and length menu\n            data.search.search = \"\";\n            data.start = 0;\n            data.columns.forEach(function(column) {\n                column.search.search = \"\";\n            });\n            return data;\n        },\n        stateSave: true,\n        \"dom\": `Blft<'row'<'col-sm-6'i><'col-sm-6'p>>`,\n        \"buttons\": [\n            {\n                extend: \"copyHtml5\",\n                text: '<i class=\"bi bi-copy fa-fw fs-unset\"></i>',\n                className: \"btn btn-sm border-0\",\n                messageTop: null,\n                title: null,\n                exportOptions: {\n                    columns: ['.exportable']\n                }\n            },\n            {\n                extend: \"csvHtml5\",\n                text: '<i class=\"bi bi-filetype-csv fa-fw fs-unset\"></i>',\n                title: title,\n                className: \"btn btn-sm border-0\",\n                exportOptions: {\n                    columns: ['.exportable']\n                }\n            },\n            {\n                extend: \"excelHtml5\",\n                text: '<i class=\"bi bi-file-earmark-excel fa-fw fs-unset\"></i>',\n                className: \"btn btn-sm border-0\",\n                title: title,\n                exportOptions: {\n                    columns: ['.exportable']\n                }\n            }\n        ],\n        \"initComplete\": function() {\n            $(`${node} table`)\n                .wrap(\"<div style='overflow:auto;position:relative' class='completiontablewrapper'></div>\");\n            $(`${node} .dataTables_length`).addClass(\"d-inline ml-1\");\n            $(`${node} .dataTables_filter`).addClass(\"d-inline float-right\");\n            $(`${node} .table-responsive`).addClass(\"p-1\");\n        }\n    };\n\n    $(`${node} table`).DataTable(tableOptions);\n};\n\nexport {\n    init,\n    renderAnnotationLogs\n};"],"names":["cmid","groupid","grademax","itemids","completionpercentage","videourl","videotype","cm","courseid","start","end","window","JSZip","getContentTypes","$","ajax","url","M","cfg","wwwroot","method","dataType","data","action","sesskey","contextid","getReportData","ctxid","courseContextId","contentTypes","tabledata","itemsdata","text","JSON","parse","when","done","async","ct","datatableOptions","visible","render","type","row","deletebutton","util","get_string","completionid","id","timecreated","className","date","Date","toLocaleString","getTime","stateSaveParams","settings","search","columns","forEach","column","stateSave","extend","messageTop","title","exportOptions","format","body","div","document","createElement","innerHTML","textContent","innerText","trim","wrap","addClass","remove","removeClass","each","itemid","this","toString","ctype","push","sortable","rtype","completiondetails","map","x","e","details","find","Number","hasDetails","reportView","DataTable","on","annotationid","closest","theAnnotation","tabledatajson","rows","toArray","formattedtitle","timestamp","seconds","h","Math","floor","m","s","convertSecondsToHMS","modal","append","fadeIn","amdmodule","name","require","Module","completed","player","prop","displayReportView","focus","preventDefault","recordid","$this","deleteCancelPromise","then","success","response","console","log","targetdata","timecompleted","xp","completeditems","draw","error","catch","saveCancel","userid","getCompletionData","node","tableOptions"],"mappings":"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"}