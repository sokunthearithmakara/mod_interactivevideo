define("mod_interactivevideo/player/wistia",["exports","jquery","core/event_dispatcher"],(function(_exports,_jquery,_event_dispatcher){var obj;
/**
   * Wistia Player class
   * Doc: https://docs.wistia.com/docs/javascript-player-api
   *
   * @module     mod_interactivevideo/player/wistia
   * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */let player;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};var _default=class{constructor(url,start,end,showControls){this.type="wistia",this.start=start,this.frequency=.3,this.support={playbackrate:!0,quality:!0};var videoId=/(?:https?:\/\/)?(?:www\.)?(?:wistia\.com)\/medias\/([^\/]+)/g.exec(url)[1];this.videoId=videoId,(0,_jquery.default)("#player").html(`<div class="wistia_embed wistia_async_${videoId} wmode=transparent\n             controlsVisibleOnLoad=${showControls} playButton=${showControls} videoFoam=false\n              fullscreenButton=false volume=0" style="height:100%;width:100%"></div>`);var self=this;_jquery.default.get("https://fast.wistia.com/oembed.json?url="+url).then((function(data){self.posterImage=data.thumbnail_url}));var ready=!1,wistiaOptions={id:videoId,onReady:function(video){player=video,end=end?Math.min(end,video.duration()):video.duration(),start>0?(video.play(),video.time(start),video.pause(),video.on("pause",(()=>{ready||(ready=!0,(0,_event_dispatcher.dispatchEvent)("iv:playerReady"))}))):(ready=!0,(0,_event_dispatcher.dispatchEvent)("iv:playerReady")),video.volume(1),video.on("pause",(()=>{ready&&(0,_event_dispatcher.dispatchEvent)("iv:playerPaused")})),video.on("seek",(e=>{ready&&(0,_event_dispatcher.dispatchEvent)("iv:playerSeek",{time:e})})),video.bind("play",(()=>{ready&&((0,_event_dispatcher.dispatchEvent)("iv:playerPlaying"),video.time()>end&&((0,_event_dispatcher.dispatchEvent)("iv:playerEnded"),video.time(start),video.pause()))})),video.on("timechange",(s=>{ready&&s>end&&((0,_event_dispatcher.dispatchEvent)("iv:playerEnded"),video.time(start),video.pause())})),video.on("error",(e=>{(0,_event_dispatcher.dispatchEvent)("iv:playerError",{error:e})})),video.on("playbackratechange",(e=>{(0,_event_dispatcher.dispatchEvent)("iv:playerRateChange",{rate:e})}))},onError:function(e){(0,_event_dispatcher.dispatchEvent)("iv:playerError",{error:e})}};if(window._wq)window._wq.push(wistiaOptions);else{var tag=document.createElement("script");tag.src="https://fast.wistia.com/assets/external/E-v1.js";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);var interval=setInterval((()=>{window._wq&&(clearInterval(interval),window._wq.push(wistiaOptions))}),1e3)}}play(){player.play()}pause(){player.pause()}stop(starttime){player.pause(),player.time(starttime)}seek(time){return player.time(time),(0,_event_dispatcher.dispatchEvent)("iv:playerSeek",{time:time}),time}getCurrentTime(){return player.time()}getDuration(){return player.duration()}isPaused(){return"paused"===player.state()}isPlaying(){return"playing"===player.state()}isEnded(){return"ended"===player.state()}ratio(){return player.aspect()>16/9?player.aspect():16/9}destroy(){player.remove()}getState(){return player.state()}setRate(rate){player.playbackRate(rate)}mute(){player.mute()}unMute(){player.unmute()}originalPlayer(){return player}setQuality(quality){return player.videoQuality(quality),(0,_event_dispatcher.dispatchEvent)("iv:playerQualityChange",{quality:quality}),quality}getQualities(){return{qualities:["auto","360","540","720","1080","2160"],qualitiesLabel:["Auto","360p","540p","720p","1080p","4k"],currentQuality:"auto"==player.videoQuality()?0:player.videoQuality()}}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=wistia.min.js.map