define("mod_interactivevideo/player/wistia",["exports","jquery","core/event_dispatcher"],(function(_exports,_jquery,_event_dispatcher){var obj;
/**
   * Wistia Player class
   *
   * @module     mod_interactivevideo/player/wistia
   * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */let player;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};var _default=class{constructor(url,start,end,showControls){this.type="wistia",this.start=start,this.frequency=.3,this.support={playbackrate:!1,quality:!1};var videoId=/(?:https?:\/\/)?(?:www\.)?(?:wistia\.com)\/medias\/([^\/]+)/g.exec(url)[1];this.videoId=videoId;var playerIframe=`<iframe id="player" src="https://fast.wistia.net/embed/iframe/${videoId}?`;playerIframe+=`seo=false&videoFoam=false&controlsVisibleOnLoad=${showControls}`,playerIframe+=`&playButton=${showControls}&time=${start}&autoPlay=false&fullscreenButton=false&playbackRate=1" `,playerIframe+='allow="autoplay;" allowtransparency="true" frameborder="0" scrolling="no" ',playerIframe+='class="wistia_embed" name="wistia_embed" msallowfullscreen></iframe>',(0,_jquery.default)("#player").replaceWith(playerIframe);var self=this;_jquery.default.get("https://fast.wistia.com/oembed.json?url="+url).then((function(data){self.posterImage=data.thumbnail_url}));var ready=!1,wistiaOptions={id:videoId,options:{autoPlay:!1,playbackRate:1,time:start,fullscreenButton:!1,controlsVisibleOnLoad:showControls,playButton:showControls,playerColor:"#54bbff",wmode:"transparent"},onReady:function(video){player=video,end=end?Math.min(end,video.duration()):video.duration();var interval=setInterval((()=>{"paused"===video.state()&&(ready=!0,(0,_event_dispatcher.dispatchEvent)("iv:playerReady"),clearInterval(interval))}),1e3);video.on("pause",(()=>{ready&&(0,_event_dispatcher.dispatchEvent)("iv:playerPaused")})),video.on("seek",(e=>{ready&&(0,_event_dispatcher.dispatchEvent)("iv:playerSeek",{time:e})})),video.bind("play",(()=>{ready&&((0,_event_dispatcher.dispatchEvent)("iv:playerPlaying"),video.time()>end&&((0,_event_dispatcher.dispatchEvent)("iv:playerEnded"),video.time(start),video.pause()))})),video.on("timechange",(s=>{(s>end||s<start)&&((0,_event_dispatcher.dispatchEvent)("iv:playerEnded"),video.time(start),video.pause()),video.unmute()})),video.on("error",(e=>{(0,_event_dispatcher.dispatchEvent)("iv:playerError",{error:e})}))},onError:function(e){(0,_event_dispatcher.dispatchEvent)("iv:playerError",{error:e})}};if(window._wq)window._wq.push(wistiaOptions);else{var tag=document.createElement("script");tag.src="https://fast.wistia.com/assets/external/E-v1.js";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);var interval=setInterval((()=>{window._wq&&(clearInterval(interval),window._wq.push(wistiaOptions))}),1e3)}}play(){player.play()}pause(){player.pause()}stop(starttime){player.pause(),player.time(starttime)}seek(time){return new Promise((resolve=>{player.time(time),resolve()}))}getCurrentTime(){return new Promise((resolve=>{resolve(player.time())}))}getDuration(){return new Promise((resolve=>{resolve(player.duration())}))}isPaused(){return new Promise((resolve=>{resolve("paused"===player.state())}))}isPlaying(){return new Promise((resolve=>{resolve("playing"===player.state())}))}isEnded(){return Promise.resolve("ended"===player.state())}ratio(){return new Promise((resolve=>{player.aspect()>16/9?resolve(player.aspect()):resolve(16/9)}))}destroy(){player.remove()}getState(){return new Promise((resolve=>{resolve(player.state())}))}setRate(rate){player.playbackRate(rate)}mute(){player.mute()}unMute(){player.unmute()}originalPlayer(){return player}setQuality(quality){return player.setQuality(quality),quality}getQualities(){return{qualities:["default","360","540","720","1080"],currentQuality:"auto"==player.videoQuality()?"default":player.videoQuality()}}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=wistia.min.js.map