define("mod_interactivevideo/player/vimeo",["exports","core/event_dispatcher"],(function(_exports,_event_dispatcher){
/**
   * Vimeo Player class
   *
   * @module     mod_interactivevideo/player/vimeo
   * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
let player;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0;var _default=class{constructor(url,start,end,showControls){var VimeoPlayer;this.type="vimeo",this.start=start,this.frequency=.27,this.support={playbackrate:!0,quality:!1};this.videoId=/(?:https?:\/\/)?(?:www\.)?(?:vimeo\.com)\/(?:video\/|)([^\/]+)/g.exec(url)[1];var posterUrl="https://vimeo.com/api/oembed.json?url=https%3A//vimeo.com/"+this.videoId,self=this;fetch(posterUrl).then((response=>response.json())).then((data=>{var poster=data.thumbnail_url;poster=poster.replace(/_\d+x\d+/,"_720x405"),self.posterImage=poster}));var option={url:url,width:1080,height:720,autoplay:!1,quality:showControls?"540p":"auto",controls:showControls,loop:!1,muted:!1,playsinline:!0,background:!1,byline:!1,portrait:!1,title:!1,transparent:!1,responsive:!1,start_time:start,end_time:end,pip:!1,fullscreen:!1,watch_full_video:!1,play_button_position:"bottom",keyboard:!1};const vimeoEvents=player=>{player.on("error",(function(e){(0,_event_dispatcher.dispatchEvent)("iv:playerError",{error:e})})),player.on("loaded",(function(){player.getDuration().then((function(duration){end=end?Math.min(end,duration):duration})),(0,_event_dispatcher.dispatchEvent)("iv:playerReady")})),player.on("timeupdate",(async function(){let isEnded=await player.getEnded(),currentTime=await player.getCurrentTime();isEnded||end&&currentTime>=end?((0,_event_dispatcher.dispatchEvent)("iv:playerEnded"),player.pause()):await player.getPaused()?(0,_event_dispatcher.dispatchEvent)("iv:playerPaused"):(0,_event_dispatcher.dispatchEvent)("iv:playerPlaying")})),player.on("seeked",(function(e){(0,_event_dispatcher.dispatchEvent)("iv:playerSeek",{time:e.seconds})})),player.on("playbackratechange",(function(e){(0,_event_dispatcher.dispatchEvent)("iv:playerRateChange",{rate:e.playbackRate})}))};VimeoPlayer?(player=new VimeoPlayer("player",option),vimeoEvents(player)):require(["https://player.vimeo.com/api/player.js"],(function(Player){VimeoPlayer=Player,player=new Player("player",option),vimeoEvents(player)}))}play(){player.play()}pause(){player.pause()}stop(starttime){player.setCurrentTime(starttime),player.pause()}seek(time){return new Promise((resolve=>{player.setCurrentTime(time),resolve()}))}getCurrentTime(){return new Promise((resolve=>{player.getCurrentTime().then((function(time){resolve(time)}))}))}getDuration(){return new Promise((resolve=>{player.getDuration().then((function(duration){resolve(duration)}))}))}isPaused(){return new Promise((resolve=>{player.getPaused().then((function(paused){resolve(paused)}))}))}isPlaying(){return new Promise((resolve=>{player.getPaused().then((function(paused){resolve(!paused)}))}))}isEnded(){player.getEnded().then((function(ended){return Promise.resolve(ended)}))}ratio(){return new Promise((resolve=>{player.getVideoWidth().then((function(width){player.getVideoHeight().then((function(height){resolve(width/height>16/9?width/height:16/9)}))}))}))}destroy(){player.destroy()}getState(){return new Promise((resolve=>{player.getPaused().then((function(paused){resolve(paused?"paused":"playing")}))}))}setRate(rate){player.setPlaybackRate(rate)}mute(){player.setVolume(0)}unMute(){player.setVolume(1)}originalPlayer(){return player}setQuality(quality){return player.setQuality(quality),quality}getQuality(){return player.getQualities()}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=vimeo.min.js.map