define("mod_interactivevideo/player/dailymotion",["exports","core/event_dispatcher","jquery"],(function(_exports,_event_dispatcher,_jquery){var obj;
/**
   * DailyMotion Player class
   * Documented at https://developers.dailymotion.com/sdk/player-sdk/web/
   * @module     mod_interactivevideo/player/dailymotion
   * @copyright  2024 Sokunthearith Makara <sokunthearithmakara@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */let player;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};var _default=class{constructor(url,start,end,showControls){let customStart=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.type="dailymotion",this.start=start,this.frequency=.27,this.support={playbackrate:!0,quality:!0};var videoId=/(?:https?:\/\/)?(?:www\.)?(?:dai\.ly|dailymotion\.com)\/(?:embed\/video\/|video\/|)([^\/]+)/g.exec(url)[1];this.videoId=videoId;var self=this;fetch("https://api.dailymotion.com/video/".concat(videoId,"?fields=thumbnail_720_url")).then((response=>response.json())).then((data=>{self.posterImage=data.thumbnail_720_url})).catch((()=>{}));var ready=!1,dmOptions={video:videoId,params:{startTime:start}};let dailymotion;const dailymotionEvents=player=>{showControls&&player.setQuality(480),player.getState().then((function(state){end=end?Math.min(end,state.videoDuration):state.videoDuration})).catch((()=>{})),customStart?(player.setMute(!0),player.play(),player.on(dailymotion.events.VIDEO_START,(function(){1==ready&&player.setMute(!0),setTimeout((()=>{player.seek(start),player.setMute(!1),ready||(player.pause(),ready=!0,(0,_event_dispatcher.dispatchEvent)("iv:playerReady"))}),1e3)}))):(ready=!0,(0,_event_dispatcher.dispatchEvent)("iv:playerReady")),player.on(dailymotion.events.AD_START,(function(){(0,_jquery.default)(".video-block").css("background","transparent")})),player.on(dailymotion.events.VIDEO_SEEKEND,(function(e){(0,_event_dispatcher.dispatchEvent)("iv:playerSeek",e.videoTime)})),player.on(dailymotion.events.VIDEO_END,(function(){player.seek(start),player.pause(),(0,_event_dispatcher.dispatchEvent)("iv:playerEnded")})),player.on(dailymotion.events.VIDEO_TIMECHANGE,(function(e){ready&&(e.videoTime>=end?((0,_event_dispatcher.dispatchEvent)("iv:playerEnded"),player.pause()):!1===e.playerIsPlaying?(0,_event_dispatcher.dispatchEvent)("iv:playerPaused"):!0===e.playerIsPlaying&&(0,_event_dispatcher.dispatchEvent)("iv:playerPlaying"))})),player.on(dailymotion.events.PLAYER_ERROR,(function(e){(0,_event_dispatcher.dispatchEvent)("iv:playerError",{error:e})})),player.on(dailymotion.events.PLAYER_PLAYBACKSPEEDCHANGE,(function(e){(0,_event_dispatcher.dispatchEvent)("iv:playerRateChange",{rate:e.playerPlaybackSpeed})})),player.on(dailymotion.events.VIDEO_QUALITYCHANGE,(function(e){(0,_event_dispatcher.dispatchEvent)("iv:playerQualityChange",{quality:e.videoQuality})}))};if(window.dailymotion)window.dailymotion.createPlayer("player",dmOptions).then((function(pl){player=pl,dailymotionEvents(player),dailymotion=window.dailymotion})).catch((()=>{}));else{var tag=document.createElement("script");tag.src=showControls?"https://geo.dailymotion.com/libs/player/xsyje.js":"https://geo.dailymotion.com/libs/player/xsyj8.js";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag),window.dailymotion={onScriptLoaded:()=>{dailymotion=window.dailymotion,dailymotion.createPlayer("player",dmOptions).then((function(pl){player=pl,dailymotionEvents(player)})).catch((()=>{}))}}}}play(){player.play()}pause(){player.pause()}stop(starttime){player.seek(starttime),player.pause()}async seek(time){await player.seek(time),(0,_event_dispatcher.dispatchEvent)("iv:playerSeek",{time:time})}async getCurrentTime(){return(await player.getState()).videoTime}async getDuration(){return(await player.getState()).videoDuration}async isPaused(){return!(await player.getState()).playerIsPlaying}async isPlaying(){return(await player.getState()).playerIsPlaying}async isEnded(){return(await player.getState()).playerIsReplayScreen}async ratio(){const ratio=(await player.getState()).playerAspectRatio.split(":");return ratio[0]/ratio[1]>16/9?ratio[0]/ratio[1]:16/9}destroy(){player.destroy()}async getState(){return await player.getState()}setRate(rate){player.setPlaybackSpeed(rate)}mute(){player.setMute(!0)}unMute(){player.setMute(!1)}originalPlayer(){return player}setQuality(quality){player.setQuality(quality)}async getQualities(){let states=await this.getState();return{qualities:["default",...states.videoQualitiesList],qualitiesLabel:["Auto",...states.videoQualitiesList],currentQuality:"Auto"==states.videoQuality?"default":states.videoQuality}}};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=dailymotion.min.js.map